import{r as m,A as M,b as P,o,c as a,d as y,w as v,B as L,C as I,g as l,f as r,S as N,D as T,P as D,G as z,i as s,e as t,H as F,_ as R,I as q,t as h,k as H,v as J,T as B,h as E,p as U,l as j,J as K}from"./index-141dfb7c.js";const O={key:0,class:"products-slider__by-category"},Q=t("div",{class:"products-slider__pagination"},null,-1),W={key:1},X={__name:"RecommendedSlider",props:{recommendedProducts:{type:String,required:!0}},setup(g){const c=g,e=m([]),d=m(!1),f=m(!1),k=m("Произошла ошибка при  загрузке товаров!");M(()=>c.recommendedProducts,async()=>{d.value=!0;let n="none";try{if(c.recommendedProducts)if(c.recommendedProducts.split(",").length>0){let p=c.recommendedProducts.split(",");n=p[w(0,p.length-1)].trim()}else n=c.recommendedProducts.trim();const _=await F(n,10);e.value=_}catch(_){f.value=!0,k.value=_.message,console.log(recommendedProducts.err)}d.value=!1},{immediate:!0});function w(n,_){let p=n-.5+Math.random()*(_-n+1);return Math.round(p)}const V={slidesPerView:3,spaceBetween:30,navigation:{clickable:!0,prevEl:".products-slider__arrow.icon-arrow-left",nextEl:".products-slider__arrow.icon-arrow-right"},pagination:{clickable:!0,el:".products-slider__pagination"},breakpoints:{0:{slidesPerView:1,spaceBetween:0},420:{spaceBetween:30,slidesPerView:2},1e3:{slidesPerView:3},1700:{slidesPerView:3,spaceBetween:80}}};return(n,_)=>{const p=P("SingleProduct"),S=P("LoadingGif"),u=P("VErrorMessage");return o(),a(L,null,[e.value.length?(o(),a("div",O,[y(r(z),T({modules:[r(D)]},V,{class:"products-slider__slider"}),{default:v(()=>[(o(!0),a(L,null,I(e.value,i=>(o(),l(r(N),{key:i.product_id,class:"product-slider__slide"},{default:v(()=>[y(p,{"is-circle-product":!0,product:i},null,8,["product"])]),_:2},1024))),128)),Q]),_:1},16,["modules"])])):!f.value&&!d.value?(o(),a("p",W," Нет рекомендуемых товаров для данного ( ")):s("",!0),d.value?(o(),l(S,{key:2,"bg-color":"gray"})):s("",!0),f.value?(o(),l(u,{key:3,"err-message":k.value},null,8,["err-message"])):s("",!0)],64)}}};const A=g=>(U("data-v-71c73903"),g=g(),j(),g),Y={class:"product-page"},Z={class:"product-page__back-button"},ee={class:"product-page__product-body"},te={key:1,class:"product-page__product-content product"},oe={class:"product__row"},se={class:"product__picture-col"},ce={class:"product__picture _ibg"},re=["src","alt"],ae={class:"product__info-col"},de={class:"product__name"},ne={class:"product__size"},ue={class:"product__actions"},ie={class:"product__price"},le={class:"product__current-price"},_e={key:0,class:"product__old-price"},pe={class:"product__count count-product"},ve={class:"count-product__row"},me={class:"count-product__number"},ge={key:0,class:"product__consist"},he=A(()=>t("h3",null,"Состав",-1)),ye={class:"product__add-to-cart"},Pe={key:3},fe={key:0,class:"product-page__recommended-products recomended-products"},ke=A(()=>t("div",{class:"recomended-products__title"},"Рекомендованные товары",-1)),we={class:"recomended-products__slider"},Ve={__name:"ProductView",props:{id:Number,name:String},setup(g){const c=g,e=m(null),d=m(!1),f=m(!1),k=m("Произошла ошибка(");M([()=>c.name,()=>c.id],async()=>{d.value=!0,e.value=null;try{const u=await K(c.name,c.id);console.log(u),e.value=u,u&&(u.count=1)}catch(u){k.value=u.message,f.value=!0}d.value=!1},{immediate:!0});const{isActionLoading:w,isNotLoggedUser:V,isProductAdded:n,actionErrorMessage:_,isAddProductError:p,addProductAction:S}=q();return(u,i)=>{const G=P("VGoBackButton"),x=P("LoadingGif"),b=P("VAlert"),$=P("VErrorMessage");return o(),a("div",Y,[t("div",Z,[y(G)]),t("div",ee,[d.value?(o(),l(x,{key:0})):s("",!0),e.value?(o(),a("div",te,[t("div",oe,[t("div",se,[t("div",ce,[t("img",{src:`https://sushi-backend-henna.vercel.app/Products/${e.value.image}`,alt:e.value.name},null,8,re)])]),t("div",ae,[t("div",de,h(e.value.name),1),t("div",ne,h(e.value.textSize),1),t("div",ue,[t("div",ie,[t("div",le,h(e.value.Price*e.value.count)+"₽ ",1),e.value.oldPrice?(o(),a("div",_e,h(e.value.oldPrice*e.value.count)+"₽ ",1)):s("",!0)]),t("div",pe,[t("div",ve,[t("div",{class:"count-product__action count-product__action_minus",onClick:i[0]||(i[0]=C=>e.value.count<=1?"":e.value.count--)}),t("div",me,h(e.value.count),1),t("div",{class:"count-product__action icon-plus",onClick:i[1]||(i[1]=C=>e.value.count++)})])])]),e.value.consists?(o(),a("div",ge,[he,t("p",null,h(e.value.consists),1)])):s("",!0),t("div",ye,[H(t("button",{class:"btn icon-cart",onClick:i[2]||(i[2]=C=>r(S)({product_id:e.value.product_id,count:e.value.count,name:e.value.name,image:e.value.image,Price:e.value.Price}))}," Хочу! ",512),[[J,!r(w)]])]),r(w)?(o(),l(x,{key:1,class:"product__action-load"})):s("",!0),y(B,{name:"product-message"},{default:v(()=>[r(n)?(o(),l(b,{key:0,position:"static",type:"success"},{default:v(()=>[E(" Товар добавлен в корзину! ")]),_:1})):s("",!0)]),_:1}),y(B,{name:"product-message"},{default:v(()=>[r(p)?(o(),l(b,{key:0,position:"static",type:"error"},{default:v(()=>[E(h(r(_)),1)]),_:1})):s("",!0)]),_:1}),y(B,{name:"product-message"},{default:v(()=>[r(V)?(o(),l(b,{key:0,position:"static",type:"info"},{default:v(()=>[E(" Для добавления товара в корзину необходимо сначала войти в аккаунт! ")]),_:1})):s("",!0)]),_:1})])])])):s("",!0),f.value?(o(),l($,{key:2,style:{"margin-bottom":"20px"},"err-message":k.value},null,8,["err-message"])):!d.value&&!e.value?(o(),a("p",Pe," Не удалось найти товар с таким именем и айди :( ")):s("",!0)]),e.value?(o(),a("div",fe,[ke,t("div",we,[y(X,{"recommended-products":e.value.recommendedCat},null,8,["recommended-products"])])])):s("",!0)])}}},be=R(Ve,[["__scopeId","data-v-71c73903"]]);export{be as default};
