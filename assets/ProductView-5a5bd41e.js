import{r as m,A as D,f as G,_ as M,H as N,a as g,I as z,o,b as d,e as t,d as p,u as e,i as k,g as c,D as b,t as n,G as T,w as v,T as h,p as F,k as H}from"./index-e0ec67de.js";const U=r=>{const _=m(null),i=m(!1),l=m(!1),s=m("Произошла ошибка(");return D(r,async()=>{i.value=!0,_.value=null;const a=await G(`/api/products/${r.name}/${r.id}`);a.length&&(_.value=a[0],_.value.count=1),a.err&&(s.value=a.err,l.value=!0,console.log(a.err)),i.value=!1},{immediate:!0}),{pageProduct:_,isLoading:i,isErr:l,errorMessage:s}};const w=r=>(F("data-v-517c67af"),r=r(),H(),r),j={class:"product-page"},q={class:"product-page__back-button"},J={class:"product-page__product-body"},K={key:1,class:"product-page__product-content product"},O={class:"product__row"},Q={class:"product__picture-col"},R={class:"product__picture _ibg"},W=["alt"],X={class:"product__info-col"},Y={class:"product__name"},Z={class:"product__size"},ee={class:"product__actions"},se={class:"product__price"},te={class:"product__current-price"},oe={key:0,class:"product__old-price"},ce={class:"product__count count-product"},de={class:"count-product__row"},re={class:"count-product__number"},ae={key:0,class:"product__consist"},ne=w(()=>t("h3",null,"Состав",-1)),_e={class:"product__add-to-cart"},ie={key:0,class:"product-page__message product-message_success"},ue={key:0,class:"product-page__message product-message_error"},pe={key:0,class:"product-page__message product-message_same"},le={key:0,class:"product-page__message product-message_error"},me={key:3},ge={key:0,class:"product-page__recommended-products recomended-products"},ve=w(()=>t("div",{class:"recomended-products__title"},"Рекомендованные товары ",-1)),he={class:"recomended-products__slider"},ke={__name:"ProductView",props:{id:Number,name:String},setup(r){const _=r,{isErr:i,isLoading:l,pageProduct:s,errorMessage:a}=U(_),{addProductAction:S,isActionLoading:f,isNotLoggedUser:V,isAlreadyInCart:B,isProductAdded:C,actionErrorMessage:E,isAddProductError:A}=N();return(fe,u)=>{const L=g("VGoBackButton"),y=g("LoadingGif"),x=g("VErrorMessage"),I=g("ProductsSlider"),$=z("lazy");return o(),d("div",j,[t("div",q,[p(L)]),t("div",J,[e(l)?(o(),k(y,{key:0})):c("",!0),e(s)?(o(),d("div",K,[t("div",O,[t("div",Q,[t("div",R,[b(t("img",{alt:e(s).name},null,8,W),[[$,{src:`https://sushi-backend-henna.vercel.app/Products/${e(s).image}`,loading:"https://sushi-backend-henna.vercel.app/Load.gif",error:"https://sushi-backend-henna.vercel.app/Err.png"}]])])]),t("div",X,[t("div",Y,n(e(s).name),1),t("div",Z,n(e(s).textSize),1),t("div",ee,[t("div",se,[t("div",te,n(e(s).Price*e(s).count)+"₽",1),e(s).oldPrice?(o(),d("div",oe,n(e(s).oldPrice*e(s).count)+"₽ ",1)):c("",!0)]),t("div",ce,[t("div",de,[t("div",{class:"count-product__action count-product__action_minus",onClick:u[0]||(u[0]=P=>e(s).count<=1?"":e(s).count--)}),t("div",re,n(e(s).count),1),t("div",{class:"count-product__action icon-plus",onClick:u[1]||(u[1]=P=>e(s).count++)})])])]),e(s).consists?(o(),d("div",ae,[ne,t("p",null,n(e(s).consists),1)])):c("",!0),t("div",_e,[b(t("button",{class:"btn icon-cart",onClick:u[2]||(u[2]=P=>e(S)({product_id:e(s).product_id,count:e(s).count,name:e(s).name,image:e(s).image,Price:e(s).Price}))},"Хочу!",512),[[T,!e(f)]])]),e(f)?(o(),k(y,{key:1,class:"product__action-load"})):c("",!0),p(h,{name:"product-message"},{default:v(()=>[e(C)?(o(),d("div",ie," Товар добавлен в корзину! ")):c("",!0)]),_:1}),p(h,{name:"product-message"},{default:v(()=>[e(A)?(o(),d("div",ue,n(e(E)),1)):c("",!0)]),_:1}),p(h,{name:"product-message"},{default:v(()=>[e(B)?(o(),d("div",pe," Упс, товар уже находится в корзине! ")):c("",!0)]),_:1}),p(h,{name:"product-message"},{default:v(()=>[e(V)?(o(),d("div",le," Для добавления товара в корзину необходимо сначала войти в аккаунт! ")):c("",!0)]),_:1})])])])):c("",!0),e(i)?(o(),k(x,{key:2,"err-message":e(a)},null,8,["err-message"])):c("",!0),!e(l)&&!e(s)&&!e(i)?(o(),d("p",me,"Не удалось найти товар с таким именем и айди, проверьте ссылку! ")):c("",!0)]),e(s)?(o(),d("div",ge,[ve,t("div",he,[p(I,{"recommended-products":e(s).recommendedCat},null,8,["recommended-products"])])])):c("",!0)])}}},Pe=M(ke,[["__scopeId","data-v-517c67af"]]);export{Pe as default};
