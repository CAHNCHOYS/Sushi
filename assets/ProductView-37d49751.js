import{r as m,A as D,f as G,_ as M,H as N,a as g,I as z,o,b as r,e as s,d as u,u as e,i as k,g as c,D as b,t as n,G as T,w as v,T as h,p as F,k as H}from"./index-19896134.js";const U=d=>{const _=m(null),p=m(!1),l=m(!1),t=m("Произошла ошибка(");return D([()=>d.name,()=>d.id],async()=>{p.value=!0,_.value=null;const a=await G(`/api/products/${d.name}/${d.id}`);a.length&&(_.value=a[0],_.value.count=1),a.err&&(t.value=a.err,l.value=!0,console.log(a.err)),p.value=!1},{immediate:!0}),{pageProduct:_,isLoading:p,isErr:l,errorMessage:t}};const w=d=>(F("data-v-b3a714f8"),d=d(),H(),d),j={class:"product-page"},q={class:"product-page__back-button"},J={class:"product-page__product-body"},K={key:1,class:"product-page__product-content product"},O={class:"product__row"},Q={class:"product__picture-col"},R={class:"product__picture _ibg"},W=["alt"],X={class:"product__info-col"},Y={class:"product__name"},Z={class:"product__size"},ee={class:"product__actions"},te={class:"product__price"},se={class:"product__current-price"},oe={key:0,class:"product__old-price"},ce={class:"product__count count-product"},de={class:"count-product__row"},re={class:"count-product__number"},ae={key:0,class:"product__consist"},ne=w(()=>s("h3",null,"Состав",-1)),_e={class:"product__add-to-cart"},ie={key:0,class:"product-page__message product-message_success"},ue={key:0,class:"product-page__message product-message_error"},pe={key:0,class:"product-page__message product-message_same"},le={key:0,class:"product-page__message product-message_error"},me={key:3},ge={key:0,class:"product-page__recommended-products recomended-products"},ve=w(()=>s("div",{class:"recomended-products__title"},"Рекомендованные товары",-1)),he={class:"recomended-products__slider"},ke={__name:"ProductView",props:{id:Number,name:String},setup(d){const _=d,{isErr:p,isLoading:l,pageProduct:t,errorMessage:a}=U(_),{addProductAction:S,isActionLoading:f,isNotLoggedUser:V,isAlreadyInCart:B,isProductAdded:C,actionErrorMessage:E,isAddProductError:x}=N();return(fe,i)=>{const A=g("VGoBackButton"),y=g("LoadingGif"),L=g("VErrorMessage"),I=g("ProductsSlider"),$=z("lazy");return o(),r("div",j,[s("div",q,[u(A)]),s("div",J,[e(l)?(o(),k(y,{key:0})):c("",!0),e(t)?(o(),r("div",K,[s("div",O,[s("div",Q,[s("div",R,[b(s("img",{alt:e(t).name},null,8,W),[[$,{src:`https://sushi-backend-henna.vercel.app/Products/${e(t).image}`,loading:"https://sushi-backend-henna.vercel.app/Load.gif",error:"https://sushi-backend-henna.vercel.app/Err.png"}]])])]),s("div",X,[s("div",Y,n(e(t).name),1),s("div",Z,n(e(t).textSize),1),s("div",ee,[s("div",te,[s("div",se,n(e(t).Price*e(t).count)+"₽ ",1),e(t).oldPrice?(o(),r("div",oe,n(e(t).oldPrice*e(t).count)+"₽ ",1)):c("",!0)]),s("div",ce,[s("div",de,[s("div",{class:"count-product__action count-product__action_minus",onClick:i[0]||(i[0]=P=>e(t).count<=1?"":e(t).count--)}),s("div",re,n(e(t).count),1),s("div",{class:"count-product__action icon-plus",onClick:i[1]||(i[1]=P=>e(t).count++)})])])]),e(t).consists?(o(),r("div",ae,[ne,s("p",null,n(e(t).consists),1)])):c("",!0),s("div",_e,[b(s("button",{class:"btn icon-cart",onClick:i[2]||(i[2]=P=>e(S)({product_id:e(t).product_id,count:e(t).count,name:e(t).name,image:e(t).image,Price:e(t).Price}))}," Хочу! ",512),[[T,!e(f)]])]),e(f)?(o(),k(y,{key:1,class:"product__action-load"})):c("",!0),u(h,{name:"product-message"},{default:v(()=>[e(C)?(o(),r("div",ie," Товар добавлен в корзину! ")):c("",!0)]),_:1}),u(h,{name:"product-message"},{default:v(()=>[e(x)?(o(),r("div",ue,n(e(E)),1)):c("",!0)]),_:1}),u(h,{name:"product-message"},{default:v(()=>[e(B)?(o(),r("div",pe," Упс, товар уже находится в корзине! ")):c("",!0)]),_:1}),u(h,{name:"product-message"},{default:v(()=>[e(V)?(o(),r("div",le," Для добавления товара в корзину необходимо сначала войти в аккаунт! ")):c("",!0)]),_:1})])])])):c("",!0),e(p)?(o(),k(L,{key:2,style:{"margin-bottom":"20px"},"err-message":e(a)},null,8,["err-message"])):!e(l)&&!e(t)?(o(),r("p",me," Не удалось найти товар с таким именем и айди, проверьте ссылку! ")):c("",!0)]),e(t)?(o(),r("div",ge,[ve,s("div",he,[u(I,{"recommended-products":e(t).recommendedCat},null,8,["recommended-products"])])])):c("",!0)])}}},Pe=M(ke,[["__scopeId","data-v-b3a714f8"]]);export{Pe as default};
