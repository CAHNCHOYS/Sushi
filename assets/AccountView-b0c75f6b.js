import{_ as M,c as O,z as T,y as F,r,A as N,a as y,o as u,b as h,u as s,B as i,C as _,e,t as m,d as o,w as U,F as L,j as D,g as v,h as g,E as b,T as G,i as k,p as j,k as q}from"./index-cc6b1b0d.js";import{u as z}from"./useFormSchemas-a8f20602.js";const c=l=>(j("data-v-f552d6f0"),l=l(),q(),l),R={class:"user-account"},$={key:0,class:"user-account__body"},H=c(()=>e("div",{class:"user-account__main-title"},"Информация о вас",-1)),J={class:"user-account__info"},K={class:"user-account__all-info"},P={class:"user-account__info-block"},Q=c(()=>e("div",{class:"user-account__info-text"},"Имя: ",-1)),W={class:"user-account__info-value"},X={class:"user-account__info-block"},Y=c(()=>e("div",{class:"user-account__info-text"},"email: ",-1)),Z={class:"user-account__info-value"},ee={class:"user-account__info-block"},se=c(()=>e("div",{class:"user-account__info-text"},"Телефон: ",-1)),te={class:"user-account__info-value"},ae={class:"user-account__edit"},oe={class:"edit-form__elements"},ne={class:"edit-form__element"},ce=c(()=>e("div",{class:"edit-form__element-title"},"Ваш эмайл",-1)),ie={class:"edit-form__element"},_e=c(()=>e("div",{class:"edit-form__element-title"},"Имя",-1)),re={class:"edit-form__element"},ue=c(()=>e("div",{class:"edit-form__element-title"},"Телефон",-1)),le={class:"edit-form__element"},de=["disabled"],me={key:0,class:"edit-form__success"},ve={class:"user-account__actions"},fe={__name:"AccountView",setup(l){O({validateOnBlur:!0,validateOnChange:!0,validateOnInput:!0,validateOnModelUpdate:!0});const{userEditSchema:x}=z(),t=T(),S=F(),a=r(!1),d=r(!1),f=r(!1),p=r(!1),V=r("Произошла ошибка при обновлении информации о вас(!"),E=()=>{window.confirm("Вы уверены что хотите выйти с аккаунта?")&&(t.logOutUser(),S.push("/"))},C=async w=>{d.value=!0;let n=await t.updateUserInfo(w);n.isUpdated?(p.value=!0,setTimeout(()=>{p.value=!1,a.value=!1},2500)):n.err&&(V.value=n.err.message||n.err.sqlMessage,f.value=!0,setTimeout(()=>f.value=!1,5e3)),d.value=!1},A=N(()=>({email:t.currentUser.email,name:t.currentUser.name,phone:t.currentUser.phone}));return(w,n)=>{const B=y("LoadingGif"),I=y("VErrorMessage");return u(),h("div",R,[s(t).currentUser?(u(),h("div",$,[H,i(e("div",J,[e("div",K,[e("div",P,[Q,e("div",W,m(s(t).currentUser.name),1)]),e("div",X,[Y,e("div",Z,m(s(t).currentUser.email),1)]),e("div",ee,[se,e("div",te,m(s(t).currentUser.phone),1)])])],512),[[_,!a.value]]),i(e("div",ae,[o(s(L),{onSubmit:C,class:"user-account__edit-form edit-form","validation-schema":s(x),"initial-values":s(A)},{default:U(()=>[e("div",oe,[e("div",ne,[ce,o(s(g),{name:"email",type:"text",class:"edit-form__element-input"}),o(s(b),{name:"email",class:"edit-form__wrong-data"})]),e("div",ie,[_e,o(s(g),{name:"name",type:"text",class:"edit-form__element-input"}),o(s(b),{name:"name",class:"edit-form__wrong-data"})]),e("div",re,[ue,o(s(g),{name:"phone",type:"text",class:"edit-form__element-input"}),o(s(b),{name:"phone",class:"edit-form__wrong-data"})]),i(e("div",le,[i(e("button",{disabled:d.value,type:"submit",class:"user-account__btn user-account__btn_update"}," Обновить данные! ",8,de),[[_,a.value]]),o(G,{name:"message"},{default:U(()=>[p.value?(u(),h("div",me," Информация о вас была успешно обновлена! ")):v("",!0)]),_:1})],512),[[_,a.value]]),d.value?(u(),k(B,{key:0,class:"edit-form__loading"})):v("",!0),f.value?(u(),k(I,{key:1,"error-message":"Ошибка при обновлении информации"})):v("",!0)])]),_:1},8,["validation-schema","initial-values"])],512),[[_,a.value]]),e("div",ve,[e("button",{class:"user-account__btn user-account__btn_edit",onClick:n[0]||(n[0]=pe=>a.value=!a.value)},[i(e("span",null,"Изменить данные ",512),[[_,!a.value]]),D(),i(e("span",null," Отменить изменение ",512),[[_,a.value]])]),e("button",{class:"user-account__btn",onClick:E}," Выйти с аккаунта ")])])):v("",!0),e("p",null,m(s(t).currentUser),1)])}}},be=M(fe,[["__scopeId","data-v-f552d6f0"]]);export{be as default};
