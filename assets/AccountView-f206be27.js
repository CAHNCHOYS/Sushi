import{_ as A,I as B,G as F,r as d,J as L,a as U,o as r,c as p,u as s,K as c,L as i,d as e,t as m,b as o,w as y,g as M,e as v,T as N,f as k,p as T,h as G}from"./index-e6c5bcf0.js";import{c as D,F as J,a as h,E as b}from"./vee-validate.esm-adae6640.js";import{u as K}from"./useFormSchemas-a3ddd8f3.js";const n=u=>(T("data-v-e18f7cb9"),u=u(),G(),u),R={class:"user-account"},$={key:0,class:"user-account__body"},j=n(()=>e("div",{class:"user-account__main-title"},"Информация о вас",-1)),q={class:"user-account__info"},z={class:"user-account__all-info"},H={class:"user-account__info-block"},P=n(()=>e("div",{class:"user-account__info-text"},"Имя: ",-1)),Q={class:"user-account__info-value"},W={class:"user-account__info-block"},X=n(()=>e("div",{class:"user-account__info-text"},"email: ",-1)),Y={class:"user-account__info-value"},Z={class:"user-account__info-block"},ee=n(()=>e("div",{class:"user-account__info-text"},"Телефон: ",-1)),se={class:"user-account__info-value"},te={class:"user-account__edit"},ae={class:"edit-form__elements"},oe={class:"edit-form__element"},ne=n(()=>e("div",{class:"edit-form__element-title"},"Ваш эмайл",-1)),ce={class:"edit-form__element"},ie=n(()=>e("div",{class:"edit-form__element-title"},"Имя",-1)),_e={class:"edit-form__element"},re=n(()=>e("div",{class:"edit-form__element-title"},"Телефон",-1)),ue={class:"edit-form__element"},le=["disabled"],de={key:0,class:"edit-form__success"},me={class:"user-account__actions"},ve={__name:"AccountView",setup(u){D({validateOnBlur:!0,validateOnChange:!0,validateOnInput:!0,validateOnModelUpdate:!0});const{userEditSchema:x}=K(),t=B(),S=F(),a=d(!1),l=d(!1),g=d(!1),f=d(!1),V=()=>{window.confirm("Вы уверены что хотите выйти с аккаунта?")&&(t.logOutUser(),S.push("/"))},E=async w=>{l.value=!0;let _=await t.updateUserInfo(w);_.isUpdated?(f.value=!0,setTimeout(()=>{f.value=!1,a.value=!1},2500)):_.isErr&&(g.value=!0),l.value=!1},I=L(()=>({email:t.currentUser.email,name:t.currentUser.name,phone:t.currentUser.phone}));return(w,_)=>{const C=U("LoadingGif"),O=U("VErrorMessage");return r(),p("div",R,[s(t).currentUser?(r(),p("div",$,[j,c(e("div",q,[e("div",z,[e("div",H,[P,e("div",Q,m(s(t).currentUser.name),1)]),e("div",W,[X,e("div",Y,m(s(t).currentUser.email),1)]),e("div",Z,[ee,e("div",se,m(s(t).currentUser.phone),1)])])],512),[[i,!a.value]]),c(e("div",te,[o(s(J),{onSubmit:E,class:"user-account__edit-form edit-form","validation-schema":s(x),"initial-values":s(I)},{default:y(()=>[e("div",ae,[e("div",oe,[ne,o(s(h),{name:"email",type:"text",class:"edit-form__element-input"}),o(s(b),{name:"email",class:"edit-form__wrong-data"})]),e("div",ce,[ie,o(s(h),{name:"name",type:"text",class:"edit-form__element-input"}),o(s(b),{name:"name",class:"edit-form__wrong-data"})]),e("div",_e,[re,o(s(h),{name:"phone",type:"text",class:"edit-form__element-input"}),o(s(b),{name:"phone",class:"edit-form__wrong-data"})]),c(e("div",ue,[c(e("button",{disabled:l.value,type:"submit",class:"user-account__btn user-account__btn_update"}," Обновить данные! ",8,le),[[i,a.value]]),o(N,{name:"message"},{default:y(()=>[f.value?(r(),p("div",de," Информация о вас была успешно обновлена! ")):v("",!0)]),_:1})],512),[[i,a.value]]),l.value?(r(),k(C,{key:0,class:"edit-form__loading"})):v("",!0),g.value?(r(),k(O,{key:1,"error-message":"Ошибка при обновлении информации"})):v("",!0)])]),_:1},8,["validation-schema","initial-values"])],512),[[i,a.value]]),e("div",me,[e("button",{class:"user-account__btn user-account__btn_edit",onClick:_[0]||(_[0]=fe=>a.value=!a.value)},[c(e("span",null,"Изменить данные ",512),[[i,!a.value]]),M(),c(e("span",null," Отменить изменение ",512),[[i,a.value]])]),e("button",{class:"user-account__btn",onClick:V}," Выйти с аккаунта ")])])):v("",!0),e("p",null,m(s(t).currentUser),1)])}}},ge=A(ve,[["__scopeId","data-v-e18f7cb9"]]);export{ge as default};
