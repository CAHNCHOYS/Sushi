import{r as m,C as M,a as f,o,c as d,b as y,w as v,D as L,G as I,g as l,e as a,S as N,H as T,P as D,I as z,i as s,d as t,J as F,_ as R,K as q,t as h,k as H,v as J,T as B,h as E,p as K,l as U,L as j}from"./index-1f35e4f5.js";const O={key:0,class:"products-slider__by-category"},Q=t("div",{class:"products-slider__pagination"},null,-1),W={key:1},X={__name:"RecommendedSlider",props:{recommendedProducts:{type:String,required:!0}},setup(g){const c=g,e=m([]),n=m(!1),P=m(!1),k=m("Произошла ошибка при  загрузке товаров!");M(()=>c.recommendedProducts,async()=>{e.value=[],n.value=!0;let i="none";if(c.recommendedProducts)if(c.recommendedProducts.split(",").length>0){let _=c.recommendedProducts.split(",");i=_[w(0,_.length-1)].trim()}else i=c.recommendedProducts.trim();const r=await F(i,10);r.err&&(P.value=!0,k.value=r.err,console.log(r.err)),r.length&&(e.value=r),n.value=!1},{immediate:!0});function w(i,r){let _=i-.5+Math.random()*(r-i+1);return Math.round(_)}const V={slidesPerView:3,spaceBetween:30,navigation:{clickable:!0,prevEl:".products-slider__arrow.icon-arrow-left",nextEl:".products-slider__arrow.icon-arrow-right"},pagination:{clickable:!0,el:".products-slider__pagination"},breakpoints:{0:{slidesPerView:1,spaceBetween:0},420:{spaceBetween:30,slidesPerView:2},1e3:{slidesPerView:3},1700:{slidesPerView:3,spaceBetween:80}}};return(i,r)=>{const _=f("SingleProduct"),S=f("LoadingGif"),p=f("VErrorMessage");return o(),d(L,null,[e.value.length?(o(),d("div",O,[y(a(z),T({modules:[a(D)]},V,{class:"products-slider__slider"}),{default:v(()=>[(o(!0),d(L,null,I(e.value,u=>(o(),l(a(N),{key:u.product_id,class:"product-slider__slide"},{default:v(()=>[y(_,{"is-circle-product":!0,product:u},null,8,["product"])]),_:2},1024))),128)),Q]),_:1},16,["modules"])])):!P.value&&!n.value?(o(),d("p",W," Нет рекомендуемых товаров для данного ( ")):s("",!0),n.value?(o(),l(S,{key:2,"bg-color":"gray"})):s("",!0),P.value?(o(),l(p,{key:3,"err-message":k.value},null,8,["err-message"])):s("",!0)],64)}}};const G=g=>(K("data-v-e15c9833"),g=g(),U(),g),Y={class:"product-page"},Z={class:"product-page__back-button"},ee={class:"product-page__product-body"},te={key:1,class:"product-page__product-content product"},oe={class:"product__row"},se={class:"product__picture-col"},ce={class:"product__picture _ibg"},re=["src","alt"],ae={class:"product__info-col"},de={class:"product__name"},ne={class:"product__size"},ie={class:"product__actions"},ue={class:"product__price"},le={class:"product__current-price"},_e={key:0,class:"product__old-price"},pe={class:"product__count count-product"},ve={class:"count-product__row"},me={class:"count-product__number"},ge={key:0,class:"product__consist"},he=G(()=>t("h3",null,"Состав",-1)),ye={class:"product__add-to-cart"},fe={key:3},Pe={key:0,class:"product-page__recommended-products recomended-products"},ke=G(()=>t("div",{class:"recomended-products__title"},"Рекомендованные товары",-1)),we={class:"recomended-products__slider"},Ve={__name:"ProductView",props:{id:Number,name:String},setup(g){const c=g,e=m(null),n=m(!1),P=m(!1),k=m("Произошла ошибка(");M([()=>c.name,()=>c.id],async()=>{n.value=!0,e.value=null;const p=await j(c.name,c.id);p.length&&(e.value=p[0],e.value.count=1),p.err&&(k.value=p.err,P.value=!0,console.log(p.err)),n.value=!1},{immediate:!0});const{isActionLoading:w,isNotLoggedUser:V,isProductAdded:i,actionErrorMessage:r,isAddProductError:_,addProductAction:S}=q();return(p,u)=>{const $=f("VGoBackButton"),x=f("LoadingGif"),b=f("VAlert"),A=f("VErrorMessage");return o(),d("div",Y,[t("div",Z,[y($)]),t("div",ee,[n.value?(o(),l(x,{key:0})):s("",!0),e.value?(o(),d("div",te,[t("div",oe,[t("div",se,[t("div",ce,[t("img",{src:`https://sushi-backend-henna.vercel.app/Products/${e.value.image}`,alt:e.value.name},null,8,re)])]),t("div",ae,[t("div",de,h(e.value.name),1),t("div",ne,h(e.value.textSize),1),t("div",ie,[t("div",ue,[t("div",le,h(e.value.Price*e.value.count)+"₽ ",1),e.value.oldPrice?(o(),d("div",_e,h(e.value.oldPrice*e.value.count)+"₽ ",1)):s("",!0)]),t("div",pe,[t("div",ve,[t("div",{class:"count-product__action count-product__action_minus",onClick:u[0]||(u[0]=C=>e.value.count<=1?"":e.value.count--)}),t("div",me,h(e.value.count),1),t("div",{class:"count-product__action icon-plus",onClick:u[1]||(u[1]=C=>e.value.count++)})])])]),e.value.consists?(o(),d("div",ge,[he,t("p",null,h(e.value.consists),1)])):s("",!0),t("div",ye,[H(t("button",{class:"btn icon-cart",onClick:u[2]||(u[2]=C=>a(S)({product_id:e.value.product_id,count:e.value.count,name:e.value.name,image:e.value.image,Price:e.value.Price}))}," Хочу! ",512),[[J,!a(w)]])]),a(w)?(o(),l(x,{key:1,class:"product__action-load"})):s("",!0),y(B,{name:"product-message"},{default:v(()=>[a(i)?(o(),l(b,{key:0,position:"static",type:"success"},{default:v(()=>[E(" Товар добавлен в корзину! ")]),_:1})):s("",!0)]),_:1}),y(B,{name:"product-message"},{default:v(()=>[a(_)?(o(),l(b,{key:0,position:"static",type:"error"},{default:v(()=>[E(h(a(r)),1)]),_:1})):s("",!0)]),_:1}),y(B,{name:"product-message"},{default:v(()=>[a(V)?(o(),l(b,{key:0,position:"static",type:"info"},{default:v(()=>[E(" Для добавления товара в корзину необходимо сначала войти в аккаунт! ")]),_:1})):s("",!0)]),_:1})])])])):s("",!0),P.value?(o(),l(A,{key:2,style:{"margin-bottom":"20px"},"err-message":k.value},null,8,["err-message"])):!n.value&&!e.value?(o(),d("p",fe," Не удалось найти товар с таким именем и айди, проверьте ссылку! ")):s("",!0)]),e.value?(o(),d("div",Pe,[ke,t("div",we,[y(X,{"recommended-products":e.value.recommendedCat},null,8,["recommended-products"])])])):s("",!0)])}}},be=R(Ve,[["__scopeId","data-v-e15c9833"]]);export{be as default};
