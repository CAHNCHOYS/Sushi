import{r as m,D as M,f as $,_ as G,G as I,a as g,o,b as d,e as t,d as p,u as s,i as f,g as c,t as n,B as N,C as D,w as v,T as h,p as z,k as T}from"./index-cc6b1b0d.js";const q=r=>{const _=m(null),i=m(!1),l=m(!1),e=m("Произошла ошибка(");return M(r,async()=>{i.value=!0,_.value=null;const a=await $(`/api/products/${r.name}/${r.id}`);a.length&&(_.value=a[0],_.value.count=1),a.err&&(e.value=a.err.message||a.err.sqlMessage,l.value=!0,console.log(a.err)),i.value=!1},{immediate:!0}),{pageProduct:_,isLoading:i,isErr:l,errorMessage:e}};const w=r=>(z("data-v-c6c8cf98"),r=r(),T(),r),F={class:"product-page"},U={class:"product-page__back-button"},j={class:"product-page__product-body"},H={key:1,class:"product-page__product-content product"},J={class:"product__row"},K={class:"product__picture-col"},O={class:"product__picture _ibg"},Q=["src","alt"],R={class:"product__info-col"},W={class:"product__name"},X={class:"product__size"},Y={class:"product__actions"},Z={class:"product__price"},ss={class:"product__current-price"},es={key:0,class:"product__old-price"},ts={class:"product__count count-product"},os={class:"count-product__row"},cs={class:"count-product__number"},ds={key:0,class:"product__consist"},rs=w(()=>t("h3",null,"Состав",-1)),as={class:"product__add-to-cart"},ns={key:0,class:"product-page__message product-message_success"},_s={key:0,class:"product-page__message product-message_error"},is={key:0,class:"product-page__message product-message_same"},us={key:0,class:"product-page__message product-message_error"},ps={key:3},ls={key:0,class:"product-page__recommended-products recomended-products"},ms=w(()=>t("div",{class:"recomended-products__title"},"Рекомендованные товары ",-1)),gs={class:"recomended-products__slider"},vs={__name:"ProductView",props:{id:Number,name:String},setup(r){const _=r,{isErr:i,isLoading:l,pageProduct:e,errorMessage:a}=q(_),{addProductAction:b,isActionLoading:k,isNotLoggedUser:S,isAlreadyInCart:V,isProductAdded:B,actionErrorMessage:C,isAddProductError:E}=I();return(hs,u)=>{const x=g("VGoBackButton"),y=g("LoadingGif"),A=g("VErrorMessage"),L=g("ProductsSlider");return o(),d("div",F,[t("div",U,[p(x)]),t("div",j,[s(l)?(o(),f(y,{key:0})):c("",!0),s(e)?(o(),d("div",H,[t("div",J,[t("div",K,[t("div",O,[t("img",{src:`https://sushi-backend-henna.vercel.app/Products/${s(e).image}`,alt:s(e).name},null,8,Q)])]),t("div",R,[t("div",W,n(s(e).name),1),t("div",X,n(s(e).textSize),1),t("div",Y,[t("div",Z,[t("div",ss,n(s(e).Price*s(e).count)+"₽",1),s(e).oldPrice?(o(),d("div",es,n(s(e).oldPrice*s(e).count)+"₽ ",1)):c("",!0)]),t("div",ts,[t("div",os,[t("div",{class:"count-product__action count-product__action_minus",onClick:u[0]||(u[0]=P=>s(e).count<=1?"":s(e).count--)}),t("div",cs,n(s(e).count),1),t("div",{class:"count-product__action icon-plus",onClick:u[1]||(u[1]=P=>s(e).count++)})])])]),s(e).consists?(o(),d("div",ds,[rs,t("p",null,n(s(e).consists),1)])):c("",!0),t("div",as,[N(t("button",{class:"btn icon-cart",onClick:u[2]||(u[2]=P=>s(b)({product_id:s(e).product_id,count:s(e).count,name:s(e).name,image:s(e).image,Price:s(e).Price}))},"Хочу!",512),[[D,!s(k)]])]),s(k)?(o(),f(y,{key:1,class:"product__action-load"})):c("",!0),p(h,{name:"product-message"},{default:v(()=>[s(B)?(o(),d("div",ns," Товар добавлен в корзину! ")):c("",!0)]),_:1}),p(h,{name:"product-message"},{default:v(()=>[s(E)?(o(),d("div",_s,n(s(C)),1)):c("",!0)]),_:1}),p(h,{name:"product-message"},{default:v(()=>[s(V)?(o(),d("div",is," Упс, товар уже находится в корзине! ")):c("",!0)]),_:1}),p(h,{name:"product-message"},{default:v(()=>[s(S)?(o(),d("div",us," Для добавления товара в корзину необходимо сначала войти в аккаунт! ")):c("",!0)]),_:1})])])])):c("",!0),s(i)?(o(),f(A,{key:2,"err-message":s(a)},null,8,["err-message"])):c("",!0),!s(l)&&!s(e)&&!s(i)?(o(),d("p",ps,"Не удалось найти товар с таким именем и айди, проверьте ссылку! ")):c("",!0)]),s(e)?(o(),d("div",ls,[ms,t("div",gs,[p(L,{"recommended-products":s(e).recommendedCat},null,8,["recommended-products"])])])):c("",!0)])}}},ks=G(vs,[["__scopeId","data-v-c6c8cf98"]]);export{ks as default};
