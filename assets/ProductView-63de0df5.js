import{r as v,z as $,b as y,o,c as d,d as h,w as p,B as M,C as T,g as u,f as c,S as z,D,P as F,G as R,i as s,e as t,H as A,_ as q,I as H,t as g,k as K,v as U,T as E,h as x,p as j,l as J}from"./index-20580c92.js";const O={key:0,class:"products-slider__by-category"},Q=t("div",{class:"products-slider__pagination"},null,-1),W={key:1},X={__name:"RecommendedSlider",props:{recommendedProducts:{type:String,required:!0}},setup(m){const r=m,f=v([]),e=v(!1),i=v(!1),k=v("Произошла ошибка при  загрузке товаров!");$(()=>r.recommendedProducts,async()=>{e.value=!0;let a="none";try{if(r.recommendedProducts)if(r.recommendedProducts.split(",").length>0){let _=r.recommendedProducts.split(",");a=_[w(0,_.length-1)].trim()}else a=r.recommendedProducts.trim();const l=await A.getCategoryProducts(a,10);f.value=l}catch(l){i.value=!0,k.value=l.message,console.log(recommendedProducts.err)}e.value=!1},{immediate:!0});function w(a,l){let _=a-.5+Math.random()*(l-a+1);return Math.round(_)}const V={slidesPerView:3,spaceBetween:30,navigation:{clickable:!0,prevEl:".products-slider__arrow.icon-arrow-left",nextEl:".products-slider__arrow.icon-arrow-right"},pagination:{clickable:!0,el:".products-slider__pagination"},breakpoints:{0:{slidesPerView:1,spaceBetween:0},420:{spaceBetween:30,slidesPerView:2},1e3:{slidesPerView:3},1700:{slidesPerView:3,spaceBetween:80}}};return(a,l)=>{const _=y("SingleProduct"),S=y("LoadingGif"),b=y("VErrorMessage");return o(),d(M,null,[f.value.length?(o(),d("div",O,[h(c(R),D({modules:[c(F)]},V,{class:"products-slider__slider"}),{default:p(()=>[(o(!0),d(M,null,T(f.value,n=>(o(),u(c(z),{key:n.product_id,class:"product-slider__slide"},{default:p(()=>[h(_,{"is-circle-product":!0,product:n},null,8,["product"])]),_:2},1024))),128)),Q]),_:1},16,["modules"])])):!i.value&&!e.value?(o(),d("p",W," Нет рекомендуемых товаров для данного ( ")):s("",!0),e.value?(o(),u(S,{key:2,"bg-color":"gray"})):s("",!0),i.value?(o(),u(b,{key:3,"err-message":k.value},null,8,["err-message"])):s("",!0)],64)}}};const G=m=>(j("data-v-62d0cd69"),m=m(),J(),m),Y={class:"product-page"},Z={class:"product-page__back-button"},ee={class:"product-page__product-body"},te={key:1,class:"product-page__product-content product"},oe={class:"product__row"},se={class:"product__picture-col"},ce={class:"product__picture _ibg"},re=["src","alt"],de={class:"product__info-col"},ae={class:"product__name"},ne={class:"product__size"},ue={class:"product__actions"},ie={class:"product__price"},le={class:"product__current-price"},_e={key:0,class:"product__old-price"},pe={class:"product__count count-product"},ve={class:"count-product__row"},me={class:"count-product__number"},ge={key:0,class:"product__consist"},he=G(()=>t("h3",null,"Состав",-1)),ye={class:"product__add-to-cart"},Pe={key:3},fe={key:0,class:"product-page__recommended-products recomended-products"},ke=G(()=>t("div",{class:"recomended-products__title"},"Рекомендованные товары",-1)),we={class:"recomended-products__slider"},Ve={__name:"ProductView",props:{id:Number,name:String},setup(m){const r=m,f="https://sushi-backend-henna.vercel.app",e=v(null),i=v(!1),k=v(!1),w=v("Произошла ошибка(");$([()=>r.name,()=>r.id],async()=>{i.value=!0,e.value=null;try{const n=await A.getSingleProduct(r.name,r.id);e.value=n,n&&(n.count=1)}catch(n){w.value=n.message,k.value=!0}i.value=!1},{immediate:!0});const{isActionLoading:V,isNotLoggedUser:a,isProductAdded:l,actionErrorMessage:_,isAddProductError:S,addProductAction:b}=H();return(n,P)=>{const I=y("VGoBackButton"),C=y("LoadingGif"),B=y("VAlert"),N=y("VErrorMessage");return o(),d("div",Y,[t("div",Z,[h(I)]),t("div",ee,[i.value?(o(),u(C,{key:0})):s("",!0),e.value?(o(),d("div",te,[t("div",oe,[t("div",se,[t("div",ce,[t("img",{src:`${c(f)}/Products/${e.value.image}`,alt:e.value.name},null,8,re)])]),t("div",de,[t("div",ae,g(e.value.name),1),t("div",ne,g(e.value.textSize),1),t("div",ue,[t("div",ie,[t("div",le,g(e.value.Price*e.value.count)+"₽ ",1),e.value.oldPrice?(o(),d("div",_e,g(e.value.oldPrice*e.value.count)+"₽ ",1)):s("",!0)]),t("div",pe,[t("div",ve,[t("div",{class:"count-product__action count-product__action_minus",onClick:P[0]||(P[0]=L=>e.value.count<=1?"":e.value.count--)}),t("div",me,g(e.value.count),1),t("div",{class:"count-product__action icon-plus",onClick:P[1]||(P[1]=L=>e.value.count++)})])])]),e.value.consists?(o(),d("div",ge,[he,t("p",null,g(e.value.consists),1)])):s("",!0),t("div",ye,[K(t("button",{class:"btn icon-cart",onClick:P[2]||(P[2]=L=>c(b)({product_id:e.value.product_id,count:e.value.count,name:e.value.name,image:e.value.image,Price:e.value.Price}))}," Хочу! ",512),[[U,!c(V)]])]),c(V)?(o(),u(C,{key:1,class:"product__action-load"})):s("",!0),h(E,{name:"product-message"},{default:p(()=>[c(l)?(o(),u(B,{key:0,position:"static",type:"success"},{default:p(()=>[x(" Товар добавлен в корзину! ")]),_:1})):s("",!0)]),_:1}),h(E,{name:"product-message"},{default:p(()=>[c(S)?(o(),u(B,{key:0,position:"static",type:"error"},{default:p(()=>[x(g(c(_)),1)]),_:1})):s("",!0)]),_:1}),h(E,{name:"product-message"},{default:p(()=>[c(a)?(o(),u(B,{key:0,position:"static",type:"info"},{default:p(()=>[x(" Для добавления товара в корзину необходимо сначала войти в аккаунт! ")]),_:1})):s("",!0)]),_:1})])])])):s("",!0),k.value?(o(),u(N,{key:2,style:{"margin-bottom":"20px"},"err-message":w.value},null,8,["err-message"])):!i.value&&!e.value?(o(),d("p",Pe," Не удалось найти товар с таким именем и айди :( ")):s("",!0)]),e.value?(o(),d("div",fe,[ke,t("div",we,[h(X,{"recommended-products":e.value.recommendedCat},null,8,["recommended-products"])])])):s("",!0)])}}},be=q(Ve,[["__scopeId","data-v-62d0cd69"]]);export{be as default};
