import{_ as A,m as M,q as N,s as R,u as q,a as G,r as y,x as $,b as l,o as n,c as S,d as t,w as a,T as w,e,f as s,F as j,g as u,i as _,h as d,t as k,j as x,E as F,n as z,p as D,l as P}from"./index-e8cd63f0.js";import{u as H}from"./useFormActions-f7eee9a9.js";const m=i=>(D("data-v-bdbc4300"),i=i(),P(),i),J={class:"fullscreen"},K={class:"fullscreen__body"},O={class:"fullscreen__content"},Q={class:"fullscreen__form-body"},W=m(()=>e("div",{class:"action-form__title"},"Логин",-1)),X={class:"action-form__elements"},Y={class:"action-form__element"},Z={class:"action-form__input-body"},ss=m(()=>e("div",{class:"action-form__placeholder"},"Email",-1)),es={class:"action-form__element"},os={class:"action-form__input-body"},ts=m(()=>e("div",{class:"action-form__placeholder"},"Пароль",-1)),as={class:"action-form__btns"},ns={__name:"LoginView",setup(i){const{fetchUserCartProducts:B}=M(),L=N(),f=R(),{loginSchema:V}=q(),{isInvalidFormSubmit:E,toggleBlur:p,toggleFocus:h,invalidSubmit:I}=H(),o=G(),c=y(!1),r=y("password"),C=async v=>{c.value=!0,await o.loginUser(v),o.checkIfUserLogged&&(await B(o.currentUser.id),setTimeout(()=>{L.push("/")},2e3)),c.value=!1};return $(()=>{f.query.redirect&&(o.isErrorMessageShown=!0,o.message=`Для доступа к данной странице ( ${f.query.redirect}) необходимо
        авторизироваться !`,setTimeout(()=>o.isErrorMessageShown=!1,2500))}),(v,g)=>{const b=l("VAlert"),T=l("LoadingGif"),U=l("RouterLink");return n(),S("div",J,[t(w,{name:"message"},{default:a(()=>[s(o).isSuccessMessageShown?(n(),u(b,{key:0,position:"fixed",type:"success"},{default:a(()=>[d(k(s(o).message),1)]),_:1})):_("",!0)]),_:1}),t(w,{name:"message"},{default:a(()=>[s(o).isErrorMessageShown?(n(),u(b,{key:0,position:"fixed",type:"error"},{default:a(()=>[d(k(s(o).message),1)]),_:1})):_("",!0)]),_:1}),e("div",K,[e("div",O,[e("div",Q,[t(s(j),{onSubmit:C,onInvalidSubmit:s(I),"validation-schema":s(V)},{default:a(()=>[W,e("div",X,[e("div",Y,[e("div",Z,[ss,t(s(x),{class:"action-form__input",type:"text",name:"email",onFocus:s(h),onBlur:s(p)},null,8,["onFocus","onBlur"])]),t(s(F),{class:"action-form__error-msg",name:"email"})]),e("div",es,[e("div",os,[ts,t(s(x),{class:"action-form__input",type:r.value,name:"password",onFocus:s(h),onBlur:s(p)},null,8,["type","onFocus","onBlur"])]),e("div",{class:"action-form__show-pass",onClick:g[0]||(g[0]=is=>r.value==="password"?r.value="text":r.value="password")}," Показать/скрыть пароль "),t(s(F),{class:"action-form__error-msg",name:"password"})]),e("div",as,[c.value?_("",!0):(n(),S("button",{key:0,class:z(["action-form__btn",{err:s(E)}]),type:"submit"}," Войти ",2))])])]),_:1},8,["onInvalidSubmit","validation-schema"]),c.value?(n(),u(T,{key:0})):_("",!0)]),t(U,{class:"home-button",to:"/"},{default:a(()=>[d("На главную")]),_:1})])])])}}},_s=A(ns,[["__scopeId","data-v-bdbc4300"]]);export{_s as default};
