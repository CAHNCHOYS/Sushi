import{_ as O,c as A,B as F,y as T,r as u,C as D,a as k,o as i,b as m,u as s,D as _,G as r,e,t as h,d as o,w,F as G,h as p,E as g,T as L,g as b,i as U,p as N,k as q}from"./index-390edbfe.js";import{u as R}from"./useFormSchemas-b0318b89.js";const c=l=>(N("data-v-9289146d"),l=l(),q(),l),$={class:"user-account"},j={key:0,class:"user-account__body"},z=c(()=>e("div",{class:"user-account__main-title"},"Информация о вас",-1)),H={class:"user-account__info"},J={class:"user-account__all-info"},K={class:"user-account__info-block"},P=c(()=>e("div",{class:"user-account__info-text"},"Имя:",-1)),Q={class:"user-account__info-value"},W={class:"user-account__info-block"},X=c(()=>e("div",{class:"user-account__info-text"},"email:",-1)),Y={class:"user-account__info-value"},Z={class:"user-account__info-block"},ee=c(()=>e("div",{class:"user-account__info-text"},"Телефон:",-1)),se={class:"user-account__info-value"},te={class:"user-account__edit"},ae={class:"edit-form__elements"},oe={class:"edit-form__element"},ne=c(()=>e("div",{class:"edit-form__element-title"},"Ваш эмайл",-1)),ce={class:"edit-form__element"},ie=c(()=>e("div",{class:"edit-form__element-title"},"Имя",-1)),_e={class:"edit-form__element"},re=c(()=>e("div",{class:"edit-form__element-title"},"Телефон",-1)),ue={class:"edit-form__element"},le=["disabled"],de={key:0,class:"edit-form__success"},me={class:"user-account__actions"},ve={key:1,class:"user-account__no-user"},fe={__name:"AccountView",setup(l){A({validateOnBlur:!0,validateOnChange:!0,validateOnInput:!0,validateOnModelUpdate:!0});const{userEditSchema:S}=R(),t=F(),x=T(),a=u(!1),d=u(!1),v=u(!1),f=u(!1),E=u("Произошла ошибка при обновлении информации о вас(!"),V=()=>{window.confirm("Вы уверены что хотите выйти с аккаунта?")&&(t.logOutUser(),x.push("/"))},C=async y=>{d.value=!0;let n=await t.updateUserInfo(y);n.isUpdated?(f.value=!0,setTimeout(()=>{f.value=!1,a.value=!1},2500)):n.err&&(E.value=n.err.message||n.err.sqlMessage,v.value=!0,setTimeout(()=>v.value=!1,5e3)),d.value=!1},B=D(()=>({email:t.currentUser.email,name:t.currentUser.name,phone:t.currentUser.phone}));return(y,n)=>{const I=k("LoadingGif"),M=k("VErrorMessage");return i(),m("div",$,[s(t).currentUser?(i(),m("div",j,[z,_(e("div",H,[e("div",J,[e("div",K,[P,e("div",Q,h(s(t).currentUser.name),1)]),e("div",W,[X,e("div",Y,h(s(t).currentUser.email),1)]),e("div",Z,[ee,e("div",se,h(s(t).currentUser.phone),1)])])],512),[[r,!a.value]]),_(e("div",te,[o(s(G),{onSubmit:C,class:"user-account__edit-form edit-form","validation-schema":s(S),"initial-values":s(B)},{default:w(()=>[e("div",ae,[e("div",oe,[ne,o(s(p),{name:"email",type:"text",class:"edit-form__element-input"}),o(s(g),{name:"email",class:"edit-form__wrong-data"})]),e("div",ce,[ie,o(s(p),{name:"name",type:"text",class:"edit-form__element-input"}),o(s(g),{name:"name",class:"edit-form__wrong-data"})]),e("div",_e,[re,o(s(p),{name:"phone",type:"text",class:"edit-form__element-input"}),o(s(g),{name:"phone",class:"edit-form__wrong-data"})]),_(e("div",ue,[_(e("button",{disabled:d.value,type:"submit",class:"user-account__btn user-account__btn_update"}," Обновить данные! ",8,le),[[r,a.value]]),o(L,{name:"message"},{default:w(()=>[f.value?(i(),m("div",de," Информация о вас была успешно обновлена! ")):b("",!0)]),_:1})],512),[[r,a.value]]),d.value?(i(),U(I,{key:0,class:"edit-form__loading"})):b("",!0),v.value?(i(),U(M,{key:1,"error-message":"Ошибка при обновлении информации"})):b("",!0)])]),_:1},8,["validation-schema","initial-values"])],512),[[r,a.value]]),e("div",me,[e("button",{class:"user-account__btn user-account__btn_edit",onClick:n[0]||(n[0]=he=>a.value=!a.value)},[_(e("span",null,"Изменить данные ",512),[[r,!a.value]]),_(e("span",null," Отменить изменение ",512),[[r,a.value]])]),e("button",{class:"user-account__btn",onClick:V}," Выйти с аккаунта ")])])):(i(),m("div",ve," Не удалось получить данные о пользователе "))])}}},be=O(fe,[["__scopeId","data-v-9289146d"]]);export{be as default};
