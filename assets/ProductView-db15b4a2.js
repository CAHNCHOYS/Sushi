import{r as h,B as $,C as M,_ as D,D as G,a as v,o as s,c as _,d as o,b as g,e as t,g as u,i as d,t as n,k as I,v as F,w as l,T as k,h as y,p as T,l as z}from"./index-bfef6200.js";const U=c=>{const a=h(null),p=h(!1),m=h(!1),e=h("Произошла ошибка(");return $([()=>c.name,()=>c.id],async()=>{p.value=!0,a.value=null;const r=await M(`/api/products/${c.name}/${c.id}`);r.length&&(a.value=r[0],a.value.count=1),r.err&&(e.value=r.err,m.value=!0,console.log(r.err)),p.value=!1},{immediate:!0}),{pageProduct:a,isProductLoading:p,isFetchError:m,errorMessage:e}};const w=c=>(T("data-v-1beeeb3c"),c=c(),z(),c),j={class:"product-page"},q={class:"product-page__back-button"},H={class:"product-page__product-body"},J={key:1,class:"product-page__product-content product"},K={class:"product__row"},O={class:"product__picture-col"},Q={class:"product__picture _ibg"},R=["src","alt"],W={class:"product__info-col"},X={class:"product__name"},Y={class:"product__size"},Z={class:"product__actions"},tt={class:"product__price"},et={class:"product__current-price"},ot={key:0,class:"product__old-price"},st={class:"product__count count-product"},ct={class:"count-product__row"},dt={class:"count-product__number"},rt={key:0,class:"product__consist"},nt=w(()=>o("h3",null,"Состав",-1)),at={class:"product__add-to-cart"},it={key:3},_t={key:0,class:"product-page__recommended-products recomended-products"},ut=w(()=>o("div",{class:"recomended-products__title"},"Рекомендованные товары",-1)),lt={class:"recomended-products__slider"},pt={__name:"ProductView",props:{id:Number,name:String},setup(c){const a=c,{isFetchError:p,isProductLoading:m,pageProduct:e,errorMessage:r}=U(a),{isActionLoading:P,isNotLoggedUser:S,isProductAdded:B,actionErrorMessage:x,isAddProductError:C,addProductAction:A}=G();return(mt,i)=>{const E=v("VGoBackButton"),b=v("LoadingGif"),f=v("VAlert"),L=v("VErrorMessage"),N=v("ProductsSlider");return s(),_("div",j,[o("div",q,[g(E)]),o("div",H,[t(m)?(s(),u(b,{key:0})):d("",!0),t(e)?(s(),_("div",J,[o("div",K,[o("div",O,[o("div",Q,[o("img",{src:`https://sushi-backend-henna.vercel.app/Products/${t(e).image}`,alt:t(e).name},null,8,R)])]),o("div",W,[o("div",X,n(t(e).name),1),o("div",Y,n(t(e).textSize),1),o("div",Z,[o("div",tt,[o("div",et,n(t(e).Price*t(e).count)+"₽ ",1),t(e).oldPrice?(s(),_("div",ot,n(t(e).oldPrice*t(e).count)+"₽ ",1)):d("",!0)]),o("div",st,[o("div",ct,[o("div",{class:"count-product__action count-product__action_minus",onClick:i[0]||(i[0]=V=>t(e).count<=1?"":t(e).count--)}),o("div",dt,n(t(e).count),1),o("div",{class:"count-product__action icon-plus",onClick:i[1]||(i[1]=V=>t(e).count++)})])])]),t(e).consists?(s(),_("div",rt,[nt,o("p",null,n(t(e).consists),1)])):d("",!0),o("div",at,[I(o("button",{class:"btn icon-cart",onClick:i[2]||(i[2]=V=>t(A)({product_id:t(e).product_id,count:t(e).count,name:t(e).name,image:t(e).image,Price:t(e).Price}))}," Хочу! ",512),[[F,!t(P)]])]),t(P)?(s(),u(b,{key:1,class:"product__action-load"})):d("",!0),g(k,{name:"product-message"},{default:l(()=>[t(B)?(s(),u(f,{key:0,position:"static",type:"success"},{default:l(()=>[y(" Товар добавлен в корзину! ")]),_:1})):d("",!0)]),_:1}),g(k,{name:"product-message"},{default:l(()=>[t(C)?(s(),u(f,{key:0,position:"static",type:"error"},{default:l(()=>[y(n(t(x)),1)]),_:1})):d("",!0)]),_:1}),g(k,{name:"product-message"},{default:l(()=>[t(S)?(s(),u(f,{key:0,position:"static",type:"info"},{default:l(()=>[y(" Для добавления товара в корзину необходимо сначала войти в аккаунт! ")]),_:1})):d("",!0)]),_:1})])])])):d("",!0),t(p)?(s(),u(L,{key:2,style:{"margin-bottom":"20px"},"err-message":t(r)},null,8,["err-message"])):!t(m)&&!t(e)?(s(),_("p",it," Не удалось найти товар с таким именем и айди, проверьте ссылку! ")):d("",!0)]),t(e)?(s(),_("div",_t,[ut,o("div",lt,[g(N,{"recommended-products":t(e).recommendedCat},null,8,["recommended-products"])])])):d("",!0)])}}},gt=D(pt,[["__scopeId","data-v-1beeeb3c"]]);export{gt as default};
