import{_ as M,m as U,q as N,s as R,u as q,a as G,r as S,x as $,b as _,o as n,c as w,d as t,w as a,T as b,e as s,f as e,F as j,g as u,i as l,h as d,t as k,j as x,E as F,n as z,p as D,l as P}from"./index-141dfb7c.js";import{u as H}from"./useFormActions-b82a00c3.js";const m=i=>(D("data-v-af1636a8"),i=i(),P(),i),J={class:"fullscreen"},K={class:"fullscreen__body"},O={class:"fullscreen__content"},Q={class:"fullscreen__form-body"},W=m(()=>s("div",{class:"action-form__title"},"Логин",-1)),X={class:"action-form__elements"},Y={class:"action-form__element"},Z={class:"action-form__input-body"},ee=m(()=>s("div",{class:"action-form__placeholder"},"Email",-1)),se={class:"action-form__element"},oe={class:"action-form__input-body"},te=m(()=>s("div",{class:"action-form__placeholder"},"Пароль",-1)),ae={class:"action-form__btns"},ne={__name:"LoginView",setup(i){const{fetchUserCartProducts:B}=U(),L=N(),f=R(),{loginSchema:V}=q(),{isInvalidFormSubmit:E,toggleBlur:p,toggleFocus:v,invalidSubmit:I}=H(),o=G(),r=S(!1),c=S("password"),C=async h=>{r.value=!0,await o.loginUser(h),o.checkIfUserLogged&&(await B(),setTimeout(()=>{L.push("/")},2e3)),r.value=!1};return $(()=>{f.query.redirect&&(o.isErrorMessageShown.value=!0,o.message=`Для доступа к данной странице ( ${f.query.redirect}) необходимо
        авторизироваться !`,setTimeout(()=>o.isErrorMessageShown.value=!1,2500))}),(h,g)=>{const y=_("VAlert"),T=_("LoadingGif"),A=_("RouterLink");return n(),w("div",J,[t(b,{name:"message"},{default:a(()=>[e(o).isSuccessMessageShown?(n(),u(y,{key:0,position:"fixed",type:"success"},{default:a(()=>[d(k(e(o).message),1)]),_:1})):l("",!0)]),_:1}),t(b,{name:"message"},{default:a(()=>[e(o).isErrorMessageShown?(n(),u(y,{key:0,position:"fixed",type:"error"},{default:a(()=>[d(k(e(o).message),1)]),_:1})):l("",!0)]),_:1}),s("div",K,[s("div",O,[s("div",Q,[t(e(j),{onSubmit:C,onInvalidSubmit:e(I),"validation-schema":e(V)},{default:a(()=>[W,s("div",X,[s("div",Y,[s("div",Z,[ee,t(e(x),{class:"action-form__input",type:"text",name:"email",onFocus:e(v),onBlur:e(p)},null,8,["onFocus","onBlur"])]),t(e(F),{class:"action-form__error-msg",name:"email"})]),s("div",se,[s("div",oe,[te,t(e(x),{class:"action-form__input",type:c.value,name:"password",onFocus:e(v),onBlur:e(p)},null,8,["type","onFocus","onBlur"])]),s("div",{class:"action-form__show-pass",onClick:g[0]||(g[0]=ie=>c.value==="password"?c.value="text":c.value="password")}," Показать/скрыть пароль "),t(e(F),{class:"action-form__error-msg",name:"password"})]),s("div",ae,[r.value?l("",!0):(n(),w("button",{key:0,class:z(["action-form__btn",{err:e(E)}]),type:"submit"}," Войти ",2))])])]),_:1},8,["onInvalidSubmit","validation-schema"]),r.value?(n(),u(T,{key:0})):l("",!0)]),t(A,{class:"home-button",to:"/"},{default:a(()=>[d("На главную")]),_:1})])])])}}},le=M(ne,[["__scopeId","data-v-af1636a8"]]);export{le as default};
