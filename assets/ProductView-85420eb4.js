import{r as v,A as M,b as y,o,c as d,d as h,w as p,B as A,C as N,g as u,f as c,S as T,D,P as z,G as F,i as s,e as t,H as R,_ as q,I as H,t as g,k as J,v as K,T as E,h as x,p as U,l as j,J as O}from"./index-e8cd63f0.js";const Q={key:0,class:"products-slider__by-category"},W=t("div",{class:"products-slider__pagination"},null,-1),X={key:1},Y={__name:"RecommendedSlider",props:{recommendedProducts:{type:String,required:!0}},setup(m){const r=m,P=v([]),e=v(!1),i=v(!1),k=v("Произошла ошибка при  загрузке товаров!");M(()=>r.recommendedProducts,async()=>{e.value=!0;let n="none";try{if(r.recommendedProducts)if(r.recommendedProducts.split(",").length>0){let _=r.recommendedProducts.split(",");n=_[w(0,_.length-1)].trim()}else n=r.recommendedProducts.trim();const l=await R(n,10);P.value=l}catch(l){i.value=!0,k.value=l.message,console.log(recommendedProducts.err)}e.value=!1},{immediate:!0});function w(n,l){let _=n-.5+Math.random()*(l-n+1);return Math.round(_)}const V={slidesPerView:3,spaceBetween:30,navigation:{clickable:!0,prevEl:".products-slider__arrow.icon-arrow-left",nextEl:".products-slider__arrow.icon-arrow-right"},pagination:{clickable:!0,el:".products-slider__pagination"},breakpoints:{0:{slidesPerView:1,spaceBetween:0},420:{spaceBetween:30,slidesPerView:2},1e3:{slidesPerView:3},1700:{slidesPerView:3,spaceBetween:80}}};return(n,l)=>{const _=y("SingleProduct"),S=y("LoadingGif"),b=y("VErrorMessage");return o(),d(A,null,[P.value.length?(o(),d("div",Q,[h(c(F),D({modules:[c(z)]},V,{class:"products-slider__slider"}),{default:p(()=>[(o(!0),d(A,null,N(P.value,a=>(o(),u(c(T),{key:a.product_id,class:"product-slider__slide"},{default:p(()=>[h(_,{"is-circle-product":!0,product:a},null,8,["product"])]),_:2},1024))),128)),W]),_:1},16,["modules"])])):!i.value&&!e.value?(o(),d("p",X," Нет рекомендуемых товаров для данного ( ")):s("",!0),e.value?(o(),u(S,{key:2,"bg-color":"gray"})):s("",!0),i.value?(o(),u(b,{key:3,"err-message":k.value},null,8,["err-message"])):s("",!0)],64)}}};const $=m=>(U("data-v-92f6c942"),m=m(),j(),m),Z={class:"product-page"},ee={class:"product-page__back-button"},te={class:"product-page__product-body"},oe={key:1,class:"product-page__product-content product"},se={class:"product__row"},ce={class:"product__picture-col"},re={class:"product__picture _ibg"},ae=["src","alt"],de={class:"product__info-col"},ne={class:"product__name"},ue={class:"product__size"},ie={class:"product__actions"},le={class:"product__price"},_e={class:"product__current-price"},pe={key:0,class:"product__old-price"},ve={class:"product__count count-product"},me={class:"count-product__row"},ge={class:"count-product__number"},he={key:0,class:"product__consist"},ye=$(()=>t("h3",null,"Состав",-1)),fe={class:"product__add-to-cart"},Pe={key:3},ke={key:0,class:"product-page__recommended-products recomended-products"},we=$(()=>t("div",{class:"recomended-products__title"},"Рекомендованные товары",-1)),Ve={class:"recomended-products__slider"},Se={__name:"ProductView",props:{id:Number,name:String},setup(m){const r=m,P="https://sushi-backend-henna.vercel.app",e=v(null),i=v(!1),k=v(!1),w=v("Произошла ошибка(");M([()=>r.name,()=>r.id],async()=>{i.value=!0,e.value=null;try{const a=await O(r.name,r.id);console.log(a),e.value=a,a&&(a.count=1)}catch(a){w.value=a.message,k.value=!0}i.value=!1},{immediate:!0});const{isActionLoading:V,isNotLoggedUser:n,isProductAdded:l,actionErrorMessage:_,isAddProductError:S,addProductAction:b}=H();return(a,f)=>{const G=y("VGoBackButton"),C=y("LoadingGif"),B=y("VAlert"),I=y("VErrorMessage");return o(),d("div",Z,[t("div",ee,[h(G)]),t("div",te,[i.value?(o(),u(C,{key:0})):s("",!0),e.value?(o(),d("div",oe,[t("div",se,[t("div",ce,[t("div",re,[t("img",{src:`${c(P)}/Products/${e.value.image}`,alt:e.value.name},null,8,ae)])]),t("div",de,[t("div",ne,g(e.value.name),1),t("div",ue,g(e.value.textSize),1),t("div",ie,[t("div",le,[t("div",_e,g(e.value.Price*e.value.count)+"₽ ",1),e.value.oldPrice?(o(),d("div",pe,g(e.value.oldPrice*e.value.count)+"₽ ",1)):s("",!0)]),t("div",ve,[t("div",me,[t("div",{class:"count-product__action count-product__action_minus",onClick:f[0]||(f[0]=L=>e.value.count<=1?"":e.value.count--)}),t("div",ge,g(e.value.count),1),t("div",{class:"count-product__action icon-plus",onClick:f[1]||(f[1]=L=>e.value.count++)})])])]),e.value.consists?(o(),d("div",he,[ye,t("p",null,g(e.value.consists),1)])):s("",!0),t("div",fe,[J(t("button",{class:"btn icon-cart",onClick:f[2]||(f[2]=L=>c(b)({product_id:e.value.product_id,count:e.value.count,name:e.value.name,image:e.value.image,Price:e.value.Price}))}," Хочу! ",512),[[K,!c(V)]])]),c(V)?(o(),u(C,{key:1,class:"product__action-load"})):s("",!0),h(E,{name:"product-message"},{default:p(()=>[c(l)?(o(),u(B,{key:0,position:"static",type:"success"},{default:p(()=>[x(" Товар добавлен в корзину! ")]),_:1})):s("",!0)]),_:1}),h(E,{name:"product-message"},{default:p(()=>[c(S)?(o(),u(B,{key:0,position:"static",type:"error"},{default:p(()=>[x(g(c(_)),1)]),_:1})):s("",!0)]),_:1}),h(E,{name:"product-message"},{default:p(()=>[c(n)?(o(),u(B,{key:0,position:"static",type:"info"},{default:p(()=>[x(" Для добавления товара в корзину необходимо сначала войти в аккаунт! ")]),_:1})):s("",!0)]),_:1})])])])):s("",!0),k.value?(o(),u(I,{key:2,style:{"margin-bottom":"20px"},"err-message":w.value},null,8,["err-message"])):!i.value&&!e.value?(o(),d("p",Pe," Не удалось найти товар с таким именем и айди :( ")):s("",!0)]),e.value?(o(),d("div",ke,[we,t("div",Ve,[h(Y,{"recommended-products":e.value.recommendedCat},null,8,["recommended-products"])])])):s("",!0)])}}},Be=q(Se,[["__scopeId","data-v-92f6c942"]]);export{Be as default};
