import{r as m,y as M,_ as $,M as I,a as g,o,c as a,d as s,b as p,u as t,f,e as c,t as i,K as N,L as G,w as v,T as h,p as z,h as D}from"./index-e6c5bcf0.js";const T=async(r,n)=>{try{return await(await fetch(`https://sushi-backend-henna.vercel.app/api/products/${n}/${r}`)).json()}catch(d){return console.log(d),{err:d}}},j=r=>{const n=m(null),d=m(!1),u=m(!1),e=m("Произошла ошибка(");return M(r,async()=>{d.value=!0,n.value=null;const _=await T(r.id,r.name);_.length&&(n.value=_[0],n.value.count=1),_.err&&(_.err.name?e.value="Ошибка при отправке запроса при загруке товара!":e.value="Ошибка на стороне сервера при загрузке товара",u.value=!0,console.log(_.err)),d.value=!1},{immediate:!0}),{pageProduct:n,isLoading:d,isErr:u,errorMessage:e}};const w=r=>(z("data-v-c6c8cf98"),r=r(),D(),r),F={class:"product-page"},K={class:"product-page__back-button"},U={class:"product-page__product-body"},q={key:1,class:"product-page__product-content product"},H={class:"product__row"},J={class:"product__picture-col"},O={class:"product__picture _ibg"},Q=["src","alt"],R={class:"product__info-col"},W={class:"product__name"},X={class:"product__size"},Y={class:"product__actions"},Z={class:"product__price"},tt={class:"product__current-price"},et={key:0,class:"product__old-price"},st={class:"product__count count-product"},ot={class:"count-product__row"},ct={class:"count-product__number"},rt={key:0,class:"product__consist"},dt=w(()=>s("h3",null,"Состав",-1)),at={class:"product__add-to-cart"},nt={key:0,class:"product-page__message product-message_success"},_t={key:0,class:"product-page__message product-message_error"},it={key:0,class:"product-page__message product-message_same"},ut={key:0,class:"product-page__message product-message_error"},lt={key:3},pt={key:0,class:"product-page__recommended-products recomended-products"},mt=w(()=>s("div",{class:"recomended-products__title"},"Рекомендованные товары ",-1)),gt={class:"recomended-products__slider"},vt={__name:"ProductView",props:{id:Number,name:String},setup(r){const n=r,{isErr:d,isLoading:u,pageProduct:e,errorMessage:_}=j(n),{addProductAction:b,isActionLoading:k,isNotLoggedUser:S,isAlreadyInCart:V,isProductAdded:B,actionErrorMessage:C,isAddProductError:E}=I();return(ht,l)=>{const L=g("VGoBackButton"),y=g("LoadingGif"),x=g("VErrorMessage"),A=g("ProductsSlider");return o(),a("div",F,[s("div",K,[p(L)]),s("div",U,[t(u)?(o(),f(y,{key:0})):c("",!0),t(e)?(o(),a("div",q,[s("div",H,[s("div",J,[s("div",O,[s("img",{src:`https://sushi-backend-henna.vercel.app/Products/${t(e).image}`,alt:t(e).name},null,8,Q)])]),s("div",R,[s("div",W,i(t(e).name),1),s("div",X,i(t(e).textSize),1),s("div",Y,[s("div",Z,[s("div",tt,i(t(e).Price*t(e).count)+"₽",1),t(e).oldPrice?(o(),a("div",et,i(t(e).oldPrice*t(e).count)+"₽ ",1)):c("",!0)]),s("div",st,[s("div",ot,[s("div",{class:"count-product__action count-product__action_minus",onClick:l[0]||(l[0]=P=>t(e).count<=1?"":t(e).count--)}),s("div",ct,i(t(e).count),1),s("div",{class:"count-product__action icon-plus",onClick:l[1]||(l[1]=P=>t(e).count++)})])])]),t(e).consists?(o(),a("div",rt,[dt,s("p",null,i(t(e).consists),1)])):c("",!0),s("div",at,[N(s("button",{class:"btn icon-cart",onClick:l[2]||(l[2]=P=>t(b)({product_id:t(e).product_id,count:t(e).count,name:t(e).name,image:t(e).image,Price:t(e).Price}))},"Хочу!",512),[[G,!t(k)]])]),t(k)?(o(),f(y,{key:1,class:"product__action-load"})):c("",!0),p(h,{name:"product-message"},{default:v(()=>[t(B)?(o(),a("div",nt," Товар добавлен в корзину! ")):c("",!0)]),_:1}),p(h,{name:"product-message"},{default:v(()=>[t(E)?(o(),a("div",_t,i(t(C)),1)):c("",!0)]),_:1}),p(h,{name:"product-message"},{default:v(()=>[t(V)?(o(),a("div",it," Упс, товар уже находится в корзине! ")):c("",!0)]),_:1}),p(h,{name:"product-message"},{default:v(()=>[t(S)?(o(),a("div",ut," Для добавления товара в корзину необходимо сначала войти в аккаунт! ")):c("",!0)]),_:1})])])])):c("",!0),t(d)?(o(),f(x,{key:2,"err-message":t(_)},null,8,["err-message"])):c("",!0),!t(u)&&!t(e)&&!t(d)?(o(),a("p",lt,"Не удалось найти товар с таким именем и айди, проверьте ссылку! ")):c("",!0)]),t(e)?(o(),a("div",pt,[mt,s("div",gt,[p(A,{"recommended-products":t(e).recommendedCat},null,8,["recommended-products"])])])):c("",!0)])}}},kt=$(vt,[["__scopeId","data-v-c6c8cf98"]]);export{kt as default};
