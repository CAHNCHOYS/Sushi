import{_ as N,m as q,q as U,s as z,u as G,r as i,x as M,a as p,o as r,c as k,b as t,w as a,T as x,d as e,e as s,F as $,g as v,i as _,y as j,z as D,h,t as P,j as F,E as B,n as H,p as J,l as K}from"./index-1f35e4f5.js";import{u as O}from"./useFormActions-f69bc7d5.js";const g=c=>(J("data-v-b8d47a5e"),c=c(),K(),c),Q={class:"fullscreen"},W={class:"fullscreen__body"},X={class:"fullscreen__content"},Y={class:"fullscreen__form-body"},Z=g(()=>e("div",{class:"action-form__title"},"Логин",-1)),ee={class:"action-form__elements"},se={class:"action-form__element"},oe={class:"action-form__input-body"},te=g(()=>e("div",{class:"action-form__placeholder"},"Email",-1)),ae={class:"action-form__element"},ne={class:"action-form__input-body"},ie=g(()=>e("div",{class:"action-form__placeholder"},"Пароль",-1)),re={class:"action-form__btns"},ce={__name:"LoginView",setup(c){const{fetchUserCartProducts:L}=q(),T=U(),y=z(),{loginSchema:V}=G(),{isInvalidFormSubmit:C,toggleBlur:b,toggleFocus:S,invalidSubmit:I}=O(),n=i(!1),d=i(!1),l=i(!1),m=i("Произошла ошибка"),u=i("password"),A=async w=>{l.value=!0;let o=await j(w);console.log(o),o.err?(m.value=o.err,n.value=!0,setTimeout(()=>n.value=!1,3e3)):o.token&&(D().addTokenToStorage(o),d.value=!0,await L(),setTimeout(()=>{T.push("/"),d.value=!1},2e3)),l.value=!1};return M(()=>{y.query.redirect&&(n.value=!0,m.value=`Для доступа к данной странице ( ${y.query.redirect}) необходимо
        авторизироваться !`,setTimeout(()=>n.value=!1,2500))}),(w,o)=>{const f=p("VAlert"),E=p("LoadingGif"),R=p("RouterLink");return r(),k("div",Q,[t(x,{name:"message"},{default:a(()=>[d.value?(r(),v(f,{key:0,position:"fixed",type:"success"},{default:a(()=>[h(" Авторизация прошла успешно! Вас переведут на главную страницу ! ")]),_:1})):_("",!0)]),_:1}),t(x,{name:"message"},{default:a(()=>[n.value?(r(),v(f,{key:0,position:"fixed",type:"error"},{default:a(()=>[h(P(m.value),1)]),_:1})):_("",!0)]),_:1}),e("div",W,[e("div",X,[e("div",Y,[t(s($),{onSubmit:A,onInvalidSubmit:s(I),"validation-schema":s(V)},{default:a(()=>[Z,e("div",ee,[e("div",se,[e("div",oe,[te,t(s(F),{class:"action-form__input",type:"text",name:"email",onFocus:s(S),onBlur:s(b)},null,8,["onFocus","onBlur"])]),t(s(B),{class:"action-form__error-msg",name:"email"})]),e("div",ae,[e("div",ne,[ie,t(s(F),{class:"action-form__input",type:u.value,name:"password",onFocus:s(S),onBlur:s(b)},null,8,["type","onFocus","onBlur"])]),e("div",{class:"action-form__show-pass",onClick:o[0]||(o[0]=le=>u.value==="password"?u.value="text":u.value="password")}," Показать/скрыть пароль "),t(s(B),{class:"action-form__error-msg",name:"password"})]),e("div",re,[l.value?_("",!0):(r(),k("button",{key:0,class:H(["action-form__btn",{err:s(C)}]),type:"submit"}," Войти ",2))])])]),_:1},8,["onInvalidSubmit","validation-schema"]),l.value?(r(),v(E,{key:0})):_("",!0)]),t(R,{class:"home-button",to:"/"},{default:a(()=>[h("На главную")]),_:1})])])])}}},de=N(ce,[["__scopeId","data-v-b8d47a5e"]]);export{de as default};
