import{_ as F,u as M,m as L,a as N,r as u,y as D,b as y,o as _,c as m,f as s,k as i,v as r,e,t as p,d as a,w as U,F as G,A as w,j as g,E as b,T as O,i as k,g as S,p as j,l as R}from"./index-20580c92.js";const c=l=>(j("data-v-3260fa8f"),l=l(),R(),l),$={class:"user-account"},q={key:0,class:"user-account__body"},z=c(()=>e("div",{class:"user-account__main-title"},"Информация о вас",-1)),H={class:"user-account__info"},J={class:"user-account__all-info"},K={class:"user-account__info-block"},Q=c(()=>e("div",{class:"user-account__info-text"},"Имя:",-1)),W={class:"user-account__info-value"},X={class:"user-account__info-block"},Y=c(()=>e("div",{class:"user-account__info-text"},"email:",-1)),Z={class:"user-account__info-value"},P={class:"user-account__info-block"},ee=c(()=>e("div",{class:"user-account__info-text"},"Телефон:",-1)),se={class:"user-account__info-value"},te={class:"user-account__edit"},oe={class:"edit-form__elements"},ae={class:"edit-form__element"},ce=c(()=>e("div",{class:"edit-form__element-title"},"Ваш эмайл",-1)),ne={class:"edit-form__element"},_e=c(()=>e("div",{class:"edit-form__element-title"},"Имя",-1)),ie={class:"edit-form__element"},re=c(()=>e("div",{class:"edit-form__element-title"},"Телефон",-1)),ue={class:"edit-form__element"},le=["disabled"],de={key:0,class:"edit-form__success"},me={class:"user-account__actions"},ve={key:1,class:"user-account__no-user"},fe={__name:"AccountView",setup(l){const{userEditSchema:x}=M(),E=L(),t=N(),o=u(!1),d=u(!1),v=u(!1),f=u(!1),V=u(""),A=async h=>{d.value=!0;try{h.id=t.currentUser.id,await w.updateInfo(h);const n=await w.getUserByToken(localStorage.getItem("token"));t.currentUser=n,f.value=!0,setTimeout(()=>{f.value=!1,o.value=!1},2500)}catch(n){V.value=n.message,v.value=!0,setTimeout(()=>v.value=!1,5e3)}d.value=!1},I=()=>{window.confirm("Вы уверены что хотите выйти с аккаунта?")&&(t.logOutUser(),E.push("/"))},B=D(()=>({email:t.currentUser.email,name:t.currentUser.name,phone:t.currentUser.phone}));return(h,n)=>{const C=y("LoadingGif"),T=y("VErrorMessage");return _(),m("div",$,[s(t).currentUser?(_(),m("div",q,[z,i(e("div",H,[e("div",J,[e("div",K,[Q,e("div",W,p(s(t).currentUser.name),1)]),e("div",X,[Y,e("div",Z,p(s(t).currentUser.email),1)]),e("div",P,[ee,e("div",se,p(s(t).currentUser.phone),1)])])],512),[[r,!o.value]]),i(e("div",te,[a(s(G),{onSubmit:A,class:"user-account__edit-form edit-form","validation-schema":s(x),"initial-values":s(B)},{default:U(()=>[e("div",oe,[e("div",ae,[ce,a(s(g),{name:"email",type:"text",class:"edit-form__element-input"}),a(s(b),{name:"email",class:"edit-form__wrong-data"})]),e("div",ne,[_e,a(s(g),{name:"name",type:"text",class:"edit-form__element-input"}),a(s(b),{name:"name",class:"edit-form__wrong-data"})]),e("div",ie,[re,a(s(g),{name:"phone",type:"text",class:"edit-form__element-input"}),a(s(b),{name:"phone",class:"edit-form__wrong-data"})]),i(e("div",ue,[i(e("button",{disabled:d.value,type:"submit",class:"user-account__btn user-account__btn_update"}," Обновить данные! ",8,le),[[r,o.value]]),a(O,{name:"message"},{default:U(()=>[f.value?(_(),m("div",de," Информация была успешно обновлена! ")):k("",!0)]),_:1})],512),[[r,o.value]]),d.value?(_(),S(C,{key:0,class:"edit-form__loading"})):k("",!0),v.value?(_(),S(T,{key:1,"error-message":"Ошибка при обновлении информации"})):k("",!0)])]),_:1},8,["validation-schema","initial-values"])],512),[[r,o.value]]),e("div",me,[e("button",{class:"user-account__btn user-account__btn_edit",onClick:n[0]||(n[0]=he=>o.value=!o.value)},[i(e("span",null,"Изменить данные ",512),[[r,!o.value]]),i(e("span",null," Отменить изменение ",512),[[r,o.value]])]),e("button",{class:"user-account__btn",onClick:I}," Выйти с аккаунта ")])])):(_(),m("div",ve," Не удалось получить данные о пользователе "))])}}},ge=F(fe,[["__scopeId","data-v-3260fa8f"]]);export{ge as default};
