import{_ as I,D as k,r as x,o as l,c as d,b as t,w as u,T as f,d as s,u as e,F as C,E,e as h,n as O,p as T,g as V}from"./index-ab39bc59.js";import{c as N,u as A,F as L,a as v,E as g}from"./vee-validate.esm-27ebad0f.js";const a=n=>(T("data-v-d08ff1d4"),n=n(),V(),n),U={key:0,class:"message message_same-user"},j=a(()=>s("div",{class:"message__body"}," Не удалось войти по ввденным данным. Пожалуйста, введите правильные данные! ",-1)),D=[j],M={key:0,class:"message message_error"},P=a(()=>s("div",{class:"message__body"}," Ошибка при отправке запрос, возможно, база данных не доступна ( ",-1)),q=[P],z={class:"fullscreen"},J={class:"fullscreen__body"},R={class:"fullscreen__content"},W={class:"fullscreen__form-body"},G=a(()=>s("div",{class:"action-form__title"},"Логин",-1)),H={class:"action-form__elements"},K={class:"action-form__element"},Q={class:"action-form__input-body"},X=a(()=>s("div",{class:"action-form__placeholder"},"Email",-1)),Y={class:"action-form__element"},Z={class:"action-form__input-body"},$=a(()=>s("div",{class:"action-form__placeholder"},"Пароль",-1)),ss={class:"action-form__input-wrapper"},es={__name:"LoginView",setup(n){const y=k();N({validateOnBlur:!0,validateOnChange:!0,validateOnInput:!0,validateOnModelUpdate:!0});const{isErr:i,loginSchema:b,toggleBlur:m,toggleFocus:p,invalidSubmit:w,isInvalidForm:S}=A(),r=x(!1),F=async c=>{try{let o=await fetch("https://vercel.com/cahnchoys/sushi-backend/login",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(c)}),_=await o.json();console.log(_),o.status===409&&(r.value=!0,setTimeout(()=>r.value=!1,3e3)),_.token&&(E().addUserToStorage(_),y.push("/"))}catch(o){console.log(o),i.value=!0,setTimeout(()=>i.value=!1,3e3)}},B=c=>{const o=c.target.closest(".action-form__element").querySelector("input");console.log(o),o.type==="password"?o.type="text":o.type="password"};return(c,o)=>(l(),d(C,null,[t(f,{name:"message"},{default:u(()=>[r.value?(l(),d("div",U,D)):h("",!0)]),_:1}),t(f,{name:"message"},{default:u(()=>[e(i)?(l(),d("div",M,q)):h("",!0)]),_:1}),s("div",z,[s("div",J,[s("div",R,[s("div",W,[t(e(L),{onSubmit:F,onInvalidSubmit:e(w),"validation-schema":e(b)},{default:u(()=>[G,s("div",H,[s("div",K,[s("div",Q,[X,t(e(v),{class:"action-form__input",type:"text",name:"email",onFocus:e(p),onBlur:e(m)},null,8,["onFocus","onBlur"])]),t(e(g),{class:"action-form__error-msg",name:"email"})]),s("div",Y,[s("div",Z,[$,t(e(v),{class:"action-form__input",type:"password",name:"password",onFocus:e(p),onBlur:e(m)},null,8,["onFocus","onBlur"])]),s("div",{class:"action-form__show-pass",onClick:B}," Показать/скрыть пароль "),t(e(g),{class:"action-form__error-msg",name:"password"})]),s("div",ss,[s("button",{class:O(["action-form__btn",{err:e(S)}]),type:"submit"}," Войти ",2)])])]),_:1},8,["onInvalidSubmit","validation-schema"])])])])])],64))}},ns=I(es,[["__scopeId","data-v-d08ff1d4"]]);export{ns as default};
