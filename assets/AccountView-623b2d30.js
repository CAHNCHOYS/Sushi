import{_ as O,c as A,B as T,y as F,r,C as N,a as y,o as u,b as h,u as s,D as i,G as _,e,t as p,d as o,w as k,F as D,j as G,g as m,h as g,E as b,T as L,i as U,p as j,k as q}from"./index-f534af03.js";import{u as R}from"./useFormSchemas-9b0b722a.js";const n=l=>(j("data-v-9f6cacde"),l=l(),q(),l),$={class:"user-account"},z={key:0,class:"user-account__body"},H=n(()=>e("div",{class:"user-account__main-title"},"Информация о вас",-1)),J={class:"user-account__info"},K={class:"user-account__all-info"},P={class:"user-account__info-block"},Q=n(()=>e("div",{class:"user-account__info-text"},"Имя: ",-1)),W={class:"user-account__info-value"},X={class:"user-account__info-block"},Y=n(()=>e("div",{class:"user-account__info-text"},"email: ",-1)),Z={class:"user-account__info-value"},ee={class:"user-account__info-block"},se=n(()=>e("div",{class:"user-account__info-text"},"Телефон: ",-1)),te={class:"user-account__info-value"},ae={class:"user-account__edit"},oe={class:"edit-form__elements"},ce={class:"edit-form__element"},ne=n(()=>e("div",{class:"edit-form__element-title"},"Ваш эмайл",-1)),ie={class:"edit-form__element"},_e=n(()=>e("div",{class:"edit-form__element-title"},"Имя",-1)),re={class:"edit-form__element"},ue=n(()=>e("div",{class:"edit-form__element-title"},"Телефон",-1)),le={class:"edit-form__element"},de=["disabled"],me={key:0,class:"edit-form__success"},ve={class:"user-account__actions"},fe={__name:"AccountView",setup(l){A({validateOnBlur:!0,validateOnChange:!0,validateOnInput:!0,validateOnModelUpdate:!0});const{userEditSchema:x}=R(),t=T(),S=F(),a=r(!1),d=r(!1),v=r(!1),f=r(!1),V=r("Произошла ошибка при обновлении информации о вас(!"),E=()=>{window.confirm("Вы уверены что хотите выйти с аккаунта?")&&(t.logOutUser(),S.push("/"))},C=async w=>{d.value=!0;let c=await t.updateUserInfo(w);c.isUpdated?(f.value=!0,setTimeout(()=>{f.value=!1,a.value=!1},2500)):c.err&&(V.value=c.err.message||c.err.sqlMessage,v.value=!0,setTimeout(()=>v.value=!1,5e3)),d.value=!1},B=N(()=>({email:t.currentUser.email,name:t.currentUser.name,phone:t.currentUser.phone}));return(w,c)=>{const I=y("LoadingGif"),M=y("VErrorMessage");return u(),h("div",$,[s(t).currentUser?(u(),h("div",z,[H,i(e("div",J,[e("div",K,[e("div",P,[Q,e("div",W,p(s(t).currentUser.name),1)]),e("div",X,[Y,e("div",Z,p(s(t).currentUser.email),1)]),e("div",ee,[se,e("div",te,p(s(t).currentUser.phone),1)])])],512),[[_,!a.value]]),i(e("div",ae,[o(s(D),{onSubmit:C,class:"user-account__edit-form edit-form","validation-schema":s(x),"initial-values":s(B)},{default:k(()=>[e("div",oe,[e("div",ce,[ne,o(s(g),{name:"email",type:"text",class:"edit-form__element-input"}),o(s(b),{name:"email",class:"edit-form__wrong-data"})]),e("div",ie,[_e,o(s(g),{name:"name",type:"text",class:"edit-form__element-input"}),o(s(b),{name:"name",class:"edit-form__wrong-data"})]),e("div",re,[ue,o(s(g),{name:"phone",type:"text",class:"edit-form__element-input"}),o(s(b),{name:"phone",class:"edit-form__wrong-data"})]),i(e("div",le,[i(e("button",{disabled:d.value,type:"submit",class:"user-account__btn user-account__btn_update"}," Обновить данные! ",8,de),[[_,a.value]]),o(L,{name:"message"},{default:k(()=>[f.value?(u(),h("div",me," Информация о вас была успешно обновлена! ")):m("",!0)]),_:1})],512),[[_,a.value]]),d.value?(u(),U(I,{key:0,class:"edit-form__loading"})):m("",!0),v.value?(u(),U(M,{key:1,"error-message":"Ошибка при обновлении информации"})):m("",!0)])]),_:1},8,["validation-schema","initial-values"])],512),[[_,a.value]]),e("div",ve,[e("button",{class:"user-account__btn user-account__btn_edit",onClick:c[0]||(c[0]=he=>a.value=!a.value)},[i(e("span",null,"Изменить данные ",512),[[_,!a.value]]),G(),i(e("span",null," Отменить изменение ",512),[[_,a.value]])]),e("button",{class:"user-account__btn",onClick:E}," Выйти с аккаунта ")])])):m("",!0)])}}},be=O(fe,[["__scopeId","data-v-9f6cacde"]]);export{be as default};
