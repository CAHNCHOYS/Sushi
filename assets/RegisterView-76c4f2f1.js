import{_ as R,r as i,a as V,o as _,c as r,b as o,w as n,T as m,d as s,u as e,F as U,e as u,n as j,f as L,p as M,g as z}from"./index-ab39bc59.js";import{c as G,u as J,F as P,a as f,E as p}from"./vee-validate.esm-27ebad0f.js";const q=async a=>{try{return await(await fetch("https://vercel.com/cahnchoys/sushi-backend/register",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(a)})).json()}catch(c){return console.log(c),{isErr:!0}}};const t=a=>(M("data-v-21862755"),a=a(),z(),a),A={key:0,class:"message message_same-user"},D=t(()=>s("div",{class:"message__body"}," Упс, пользователь с такой же почтой уже существует ( ",-1)),H=[D],K={key:0,class:"message message_error"},Q=t(()=>s("div",{class:"message__body"}," Ошибка в базе данных(возможно она сейчас не работает) ",-1)),W=[Q],X={key:0,class:"message message_success"},Y=t(()=>s("div",{class:"message__body"},"Пользователь добавлен в базу данных !)",-1)),Z=[Y],$={class:"fullscreen"},ss={class:"fullscreen__body"},es={class:"fullscreen__content"},os={class:"fullscreen__form-body"},ts=t(()=>s("div",{class:"action-form__title"},"Регистрация",-1)),as={class:"action-form__elements"},ns={class:"action-form__element"},cs={class:"action-form__input-body"},is=t(()=>s("div",{class:"action-form__placeholder"},"ФИО",-1)),_s={class:"action-form__element"},rs={class:"action-form__input-body"},ls=t(()=>s("div",{class:"action-form__placeholder"},"Email",-1)),ds={class:"action-form__element"},ms={class:"action-form__element"},us={class:"action-form__input-body"},fs=t(()=>s("div",{class:"action-form__placeholder"},"Пароль",-1)),ps={class:"action-form__element"},vs={class:"action-form__input-body"},hs=t(()=>s("div",{class:"action-form__placeholder"},"Повторите пароль",-1)),gs={class:"action-form__element"},ys={key:0,class:"action-form__login-btn"},bs={__name:"RegisterView",setup(a){G({validateOnBlur:!0,validateOnChange:!0,validateOnInput:!0,validateOnModelUpdate:!0});const c=i(!1),v=i(!1),w=i(!1),F=i(["Москва","СПБ","Донецк","Ростов"]),B=i(F.value[0]),k=l=>{B.value=l},{registerSchema:x,isErr:h,toggleBlur:g,toggleFocus:y,isInvalidForm:I,invalidSubmit:T}=J(),E=async(l,{resetForm:C})=>{let{username:b,email:S,password:O}=l,N={name:b,email:S,password:O,city:B.value};const d=await q(N);console.log(d),d.isSuccess&&(c.value=!0,setTimeout(()=>sSuccess.value=!1,3e3),C(),w.value=!0),d.isSameUser&&(v.value=!0,setTimeout(()=>v.value=!1,3e3)),d.isErr&&(h.value=!0,setTimeout(()=>{h.value=!1},3e3))};return(l,C)=>{const b=V("VCustomSelect"),S=V("router-link");return _(),r(U,null,[o(m,{name:"message"},{default:n(()=>[v.value?(_(),r("div",A,H)):u("",!0)]),_:1}),o(m,{name:"message"},{default:n(()=>[e(h)?(_(),r("div",K,W)):u("",!0)]),_:1}),o(m,{name:"message"},{default:n(()=>[c.value?(_(),r("div",X,Z)):u("",!0)]),_:1}),s("div",$,[s("div",ss,[s("div",es,[s("div",os,[o(e(P),{onSubmit:E,onInvalidSubmit:e(T),class:"fullscreen__form action-form","validation-schema":e(x)},{default:n(()=>[ts,s("div",as,[s("div",ns,[s("div",cs,[is,o(e(f),{class:"action-form__input",type:"text",name:"username",onFocus:e(y),onBlur:e(g)},null,8,["onFocus","onBlur"])]),o(e(p),{class:"action-form__error-msg",name:"username"})]),s("div",_s,[s("div",rs,[ls,o(e(f),{class:"action-form__input",name:"email",type:"text",onFocus:e(y),onBlur:e(g)},null,8,["onFocus","onBlur"])]),o(e(p),{class:"action-form__error-msg",name:"email"})]),s("div",ds,[o(b,{"default-title":"Ваш город",onUpdateValue:k,options:F.value},null,8,["options"])]),s("div",ms,[s("div",us,[fs,o(e(f),{class:"action-form__input",name:"password",onFocus:e(y),onBlur:e(g),type:"password"},null,8,["onFocus","onBlur"])]),o(e(p),{class:"action-form__error-msg",name:"password"})]),s("div",ps,[s("div",vs,[hs,o(e(f),{class:"action-form__input",name:"passwordRepeat",type:"password"})]),o(e(p),{class:"action-form__error-msg",name:"passwordRepeat"})]),s("div",gs,[s("button",{class:j(["action-form__btn",{err:e(I)}]),type:"submit"}," Регистрация ",2)])])]),_:1},8,["onInvalidSubmit","validation-schema"]),o(m,{name:"login-btn"},{default:n(()=>[w.value?(_(),r("div",ys,[o(S,{class:"action-form__btn",to:"/Login"},{default:n(()=>[L("Перейти к авторизации")]),_:1})])):u("",!0)]),_:1})])])])])],64)}}},Fs=R(bs,[["__scopeId","data-v-21862755"]]);export{Fs as default};
