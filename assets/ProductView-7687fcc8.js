import{r as g,v as I,_ as N,I as x,a as P,o as c,c as a,d as s,u as t,F as f,e as d,b as i,w as p,T as m,H as _,p as E,g as L,V as $}from"./index-6584aca8.js";const B=async(o,n)=>{try{return await(await fetch(`http://localhost:3000/api/products/${n}/${o}`)).json()}catch(r){return console.log(r),{err:r}}},G=o=>{const n=g(null),r=g(!1),u=g(!1);return I([()=>o.id,()=>o.name],async()=>{r.value=!0,n.value=null,console.log("CHANGING PARAMS!");const e=await B(o.id,o.name);console.log(e),e.length&&(n.value=e[0],n.value.count=1),e.err&&(u.value=!0,console.log(e.err)),r.value=!1},{immediate:!0}),{pageProduct:n,isLoading:r,isErr:u}};const y=o=>(E("data-v-cba37ca6"),o=o(),L(),o),z={class:"product-page"},F={class:"product-page__product-body"},H={key:0,class:"product-page__message product-message product-message_success"},M={key:0,class:"product-page__message product-message product-message_error"},T={key:0,class:"product-page__message product-message product-message_same"},j={key:0,class:"product-page__message product-message product-message_error"},D={key:1,class:"product-page__product-content product"},R={class:"product__row"},U={class:"product__picture-col"},q={class:"product__picture _ibg"},J=["src","alt"],K={class:"product__info-col"},O={class:"product__name"},Q={class:"product__size"},W={class:"product__actions"},X={class:"product__price"},Y={class:"product__current-price"},Z={key:0,class:"product__old-price"},ee={class:"product__count count-product"},te={class:"count-product__row"},se={class:"count-product__number"},oe={key:0,class:"product__consist"},ce=y(()=>s("h3",null,"Состав",-1)),de={class:"product__add-to-cart"},re=["disabled"],ae={key:3},ne={key:0,class:"product-page__recommended-products recomended-products"},ue=y(()=>s("div",{class:"recomended-products__title"},"Рекомендованные товары ",-1)),_e={class:"recomended-products__slider"},ie={__name:"ProductView",props:{id:Number,name:String},setup(o){const n=o,{isErr:r,isLoading:u,pageProduct:e}=G(n),{addProductAction:k,isNotLoggedUser:v,isAlreadyInCart:h,isProductAdded:b,isAddProductError:w}=x(),S=()=>{k({product_id:e.value.product_id,count:e.value.count,name:e.value.name,image:e.value.image,Price:e.value.Price})};return(le,l)=>{const C=P("LoadingGif"),A=P("ProductsSlider");return c(),a("div",z,[s("div",F,[t(u)?(c(),f(C,{key:0})):d("",!0),i(m,{name:"product-message"},{default:p(()=>[t(b)?(c(),a("div",H," Товар добавлен в корзину! ")):d("",!0)]),_:1}),i(m,{name:"product-message"},{default:p(()=>[t(w)?(c(),a("div",M," Упс, товар уже находится в корзине! ")):d("",!0)]),_:1}),i(m,{name:"product-message"},{default:p(()=>[t(h)?(c(),a("div",T," Упс, товар уже находится в корзине! ")):d("",!0)]),_:1}),i(m,{name:"product-message"},{default:p(()=>[t(v)?(c(),a("div",j," Для добавления товара в корзину необходимо сначала войти в аккаунт! ")):d("",!0)]),_:1}),t(e)?(c(),a("div",D,[s("div",R,[s("div",U,[s("div",q,[s("img",{src:`http://localhost:3000/Products/${t(e).image}`,alt:t(e).name},null,8,J)])]),s("div",K,[s("div",O,_(t(e).name),1),s("div",Q,_(t(e).textSize),1),s("div",W,[s("div",X,[s("div",Y,_(t(e).Price*t(e).count)+"₽",1),t(e).oldPrice?(c(),a("div",Z,_(t(e).oldPrice)+"₽ ",1)):d("",!0)]),s("div",ee,[s("div",te,[s("div",{class:"count-product__action count-product__action_minus",onClick:l[0]||(l[0]=V=>t(e).count<=1?"":t(e).count--)}),s("div",se,_(t(e).count),1),s("div",{class:"count-product__action icon-plus",onClick:l[1]||(l[1]=V=>t(e).count++)})])])]),t(e).consists?(c(),a("div",oe,[ce,s("p",null,_(t(e).consists),1)])):d("",!0),s("div",de,[s("button",{class:"btn icon-cart",disabled:t(v)||t(h),onClick:S},"Хочу!",8,re)])])])])):d("",!0),t(r)?(c(),f($,{key:2,"err-message":"Произошла ошибка при загрузке товара("},null,8,["err-message"])):d("",!0),!t(u)&&!t(e)&&!t(r)?(c(),a("p",ae,"Не удалось найти товар с таким именем и айди, проверьте ссылку! ")):d("",!0)]),t(e)?(c(),a("div",ne,[ue,s("div",_e,[i(A,{"recommended-products":t(e).recommendedCat},null,8,["recommended-products"])])])):d("",!0)])}}},me=N(ie,[["__scopeId","data-v-cba37ca6"]]);export{me as default};
